"0","lda=function(X,Y,d){"
"0","  m1=nrow(X)"
"0","  m2=nrow(Y)"
"0","  m3=ncol(X)"
"0","  m4=ncol(Y)"
"0","  XY=rbind(X,Y)"
"0","  u=apply(XY,2,mean)"
"0","  u1=apply(X,2,mean)"
"0","  u2=apply(Y,2,mean)"
"0","  sb=m1*((u1-u)%*%t(u1-u))+m2*((u2-u)%*%t(u2-u))"
"0","  sw1=matrix(0,nrow = m3,ncol = m3)"
"0","  sw2=matrix(0,nrow = m4,ncol = m4)"
"0","  for (i in 1:m1) {"
"0","    sw1=as.matrix((u1-X[i,]))%*%t(as.matrix((u1-X[i,])))+sw1"
"0","  }"
"0","  for (j in 1:m2) {"
"0","    sw2=as.matrix((u2-Y[j,]))%*%t(as.matrix((u2-Y[j,])))+sw2"
"0","  }"
"0","  sw=sw1+sw2"
"0","  w=solve(sw)%*%sb"
"0","  wl=eigen(w)"
"0","  M=wl$vectors"
"0","  w0=M[,c(1:d)]"
"0","  X1=X%*%w0"
"0","  Y1=Y%*%w0"
"0","  return(list(x1=X1,y1=Y1,vectors=M))"
"0","} "
