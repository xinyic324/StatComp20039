"0","library(RANN)"
"2","程辑包‘RANN’是用R版本4.0.3 来建造的"
"0","library(boot)"
"2","程辑包‘boot’是用R版本4.0.3 来建造的"
"0","library(energy)"
"2","程辑包‘energy’是用R版本4.0.3 来建造的"
"0","library(Ball)"
"2","程辑包‘Ball’是用R版本4.0.3 来建造的"
"0","Tn <- function(z, ix, sizes,k) {"
"0","n1 <- sizes[1]; n2 <- sizes[2]; n <- n1 + n2"
"0","if(is.vector(z)) z <- data.frame(z,0);"
"0","z <- z[ix, ];"
"0","NN <- nn2(data=z, k=k+1) # what's the first column?"
"0","block1 <- NN$nn.idx[1:n1,-1]"
"0","block2 <- NN$nn.idx[(n1+1):n,-1]"
"0","i1 <- sum(block1 < n1 + .5); i2 <- sum(block2 > n1+.5)"
"0","(i1 + i2) / (k * n)"
"0","}"
"0","set.seed(12345)"
"0","m<-1e3"
"0","k<-3"
"0","p<-2"
"0","mu<-0.3"
"0","n1<-50"
"0","n2<-50"
"0","R<-999"
"0","n<-n1+n2"
"0","N<-c(n1,n2)"
"0","eqdist.nn<-function(n,sizes,k){"
"0","  boot.obj<-boot(data=z,statistic=Tn,R=R,"
"0","sim = ""permutation"", sizes = sizes,k=k)"
"0","  ts <- c(boot.obj$t0,boot.obj$t)"
"0","p.value <- mean(ts>=ts[1])"
"0","list(statistic=ts[1],p.value=p.value)"
"0","}"
"0","p.values <- matrix(NA,m,3)"
"0","for(i in 1:m){"
"0","x <- matrix(rnorm(n1*p,mean=mu,sd=1.5),ncol=p);"
"0","y <- cbind(rnorm(n2,mean=mu),rnorm(n2,mean=mu));"
"0","z <- rbind(x,y)"
"0","p.values[i,1] <- eqdist.nn(z,N,k)$p.value"
"0","p.values[i,2] <- eqdist.etest(z,sizes=N,R=R)$p.value"
"0","p.values[i,3] <- bd.test(x=x,y=y,num.permutations=999,seed=i*12345)$p.value"
"0","}"
"2","
"
