"0","pca=function(X){"
"0","  x0=apply(X,1,mean)"
"0","  sigma=(X-x0)%*%t(X-x0)"
"0","  svdw=eigen(sigma)"
"0","  percentage2=function(X,per){"
"0","    arraysum=sum(X)"
"0","    m=length(X)"
"0","    temarray=0"
"0","    num=0"
"0","    for (i in 1:m) {"
"0","      temarray=temarray+X[i]"
"0","      num=num+1"
"0","      if(temarray>=arraysum*per)break"
"0","    }"
"0","    return(num)"
"0","  }"
"0","  d=percentage2(svdw$values,per=0.90)"
"0","  w1=svdw$vectors"
"0","  W=w1[,(1:d)]"
"0","  Y=t(W)%*%(X-x0)"
"0","  reY=W%*%Y+x0"
"0","  return(list(Y=Y,reY=reY,x0=x0,num=d))"
"0","}"
"0","X=matrix(runif(7,min=165,max=180),nrow = 1,ncol = 7)"
"0","Y=matrix(runif(7,min=55,max=75),nrow = 1,ncol = 7)"
"0","Z=matrix(runif(7,min = 17,max = 20),nrow = 1,ncol = 7)"
"0","sigma=c(1:ncol(Z))"
"0","Acc = rbind(X,Y,Z)"
"0","Acc = round(Acc)"
"0","rownames(Acc) = c(""Heights"",""Weights"",""age"")"
"0","colnames(Acc) = paste(""X"",sigma)"
"0","knitr::kable(Acc)"
