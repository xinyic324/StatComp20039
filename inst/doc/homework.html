<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xinyi C" />

<meta name="date" content="2020-12-20" />

<title>Homework answers</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework answers</h1>
<h4 class="author">Xinyi C</h4>
<h4 class="date">2020-12-20</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>That is the all functions for all homework answers.</p>
</div>
<div id="section" class="section level2">
<h2>2020-09-22</h2>
<p>The source R code for the answers is as follows:</p>
<p>Example 1</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">plot</span>(iris)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Example 2</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(cars))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">speed</th>
<th align="right">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>Example 3</p>
<p><span class="math display">\[\ f(n)=n^6+4n^3+5|_{n = 45}\]</span></p>
<p><span class="math display">\[\cos(3\theta)=\cos^3\theta-\sin^3\theta\]</span></p>
<p><span class="math display">\[\sqrt[n+2]{a}\]</span></p>
</div>
<div id="section-1" class="section level2">
<h2>2020-09-29</h2>
<p><em>1.exercise</em> The source R code for the answers is as follows: If <span class="math inline">\(X\)</span> is a continuous random variable with cdf <span class="math inline">\(F_{X}(x),\)</span> then <span class="math inline">\(U=F_{X}(X) \sim\)</span> Uniform(0,1). <span class="math inline">\(F_{X}^{-1}(U)\)</span> has the same distribution as <span class="math inline">\(X\)</span>. The Pareto(a, b) distribution has cdf <span class="math display">\[
F(x)=1-\left(\frac{b}{x}\right)^{a}, \quad x \geq b&gt;0, a&gt;0
\]</span> X has density function <span class="math display">\[
p(x)=\frac{\ a*b^{\alpha}}{x^{\alpha+1}}
\]</span> and x can be presented as <span class="math display">\[
x=\ {b(1-u)}^{-\frac{1}{\alpha}}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb3-3"><a href="#cb3-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">Pareto</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb3-5"><a href="#cb3-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">.01</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">/</span>(y<span class="op">^</span><span class="dv">3</span>) )</span></code></pre></div>
<p><em>2.exrecise</em> The source R code for the answers is as follows:</p>
<p>As the question shows that the x is a symmetric density function <span class="math inline">\(\ f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1\)</span> We can know by calculation that the probability density function of <span class="math inline">\(U_{1}, U_{2}, U_{3}\)</span> is <span class="math inline">\(\ p(U_{i})=\frac{1}{2}I_{ \left\{\ -1\le U_i\le 1 \right\} }\)</span> <span class="math display">\[\ F_{x}=p(U&lt;x)=p(|U_{3}|&lt;|U_{1}|\ or|U_{3}|&lt;|U_{2}|,U&lt;U_{3})+p(|U_{3}|\geq|U_{1}|,|U_{3}|\geq|U_{2}|,U&lt;U_{2})
\]</span> <span class="math display">\[\begin{aligned} p(|U_{3}|\ge|U_{1}|,|U_{3}|\ge|U_{2}|,U&lt;U_{2}) &amp;=\frac{1}{8} \int_{-1}^{x}d u_{2} \int_{\left|U_{3}\right| \geq\left|U_{2}\right|} d u_{3} \int_{\left|U_{3}\right|&lt;\left|U_{1}\right|} d u_{1} \\ &amp;=\frac{1}{8} \int_{-1}^{x} d u_{2} \int_{\left|U_{3}\right| \geq\left|U_{2}\right|}\left(1-u_{3}\right) d u_{3} \end{aligned}\]</span> <span class="math display">\[\begin{aligned} p(|U_{3}|&lt;|U_{1}|\ or|U_{3}|&lt;|U_{2}|,U&lt;U_{3}) &amp;=-\int_{-1}^{1} d u_{3} \int_{\left|U_{3}\right| \geq\left|U_{2}\right|} d u_{2} \int_{\left|U_{3}\right| \geq\left|U_{1}\right|} d u_{1}+\frac{1+x}{2}
\end{aligned}
\]</span> <span class="math display">\[\ F_{e}(x)=p_{e}(U&lt;x)=\frac{3x}{4}-\frac{1}{4}x^3
\]</span> <span class="math display">\[\ f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1
\]</span> Conclusion satisfied.</p>
<p><em>3.exercise</em> The source R code for the answers is as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span>;</span>
<span id="cb4-2"><a href="#cb4-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n);</span>
<span id="cb4-3"><a href="#cb4-3"></a>y &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))<span class="op">-</span><span class="dv">2</span>;</span>
<span id="cb4-4"><a href="#cb4-4"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>;</span>
<span id="cb4-5"><a href="#cb4-5"></a>r &lt;-<span class="st"> </span><span class="dv">4</span>; </span>
<span id="cb4-6"><a href="#cb4-6"></a>beta &lt;-<span class="st"> </span><span class="dv">2</span>;</span>
<span id="cb4-7"><a href="#cb4-7"></a>lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(m, r, beta)</span>
<span id="cb4-8"><a href="#cb4-8"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, lambda) </span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Empirical Pareto distribution&quot;</span>))</span>
<span id="cb4-11"><a href="#cb4-11"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">lines</span>(y, r<span class="op">*</span>(beta<span class="op">^</span>r)<span class="op">*</span>((beta<span class="op">+</span>y)<span class="op">^</span>(<span class="op">-</span>r<span class="dv">-1</span>)),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Theoretical Pareto distribution&quot;</span>))</span>
<span id="cb4-14"><a href="#cb4-14"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="kw">lines</span>(x, r<span class="op">*</span>(beta<span class="op">^</span>r)<span class="op">*</span>((beta<span class="op">+</span>x)<span class="op">^</span>(<span class="op">-</span>r<span class="dv">-1</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>2020-10-13</h2>
<p><em>1.exercise</em> The source R code for the answers is as follows:</p>
<p><span class="math display">\[\int_{0}^{\pi/3}\sin t d t=\pi/3*E(sin x)\]</span>, where <span class="math display">\[\ x \sim U(0,\pi/3)\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>festim&lt;-<span class="cf">function</span>(a){</span>
<span id="cb5-2"><a href="#cb5-2"></a>x&lt;-<span class="kw">runif</span>(a,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="co">##theta.hat表示monte carlo方法生成的估计值</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))<span class="co">##theta.hat表示由monte carlo方法生成的估计值与理论值</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>}</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">festim</span>(<span class="fl">1e4</span>)</span></code></pre></div>
<pre><code>## [1] 0.4908154 0.5000000</code></pre>
<p>theta,hat represents the estimator of <span class="math inline">\(\theta\)</span>. AS we can see the results,the difference between the result and the theoretical value is not big.</p>
<p><em>2.exercise</em> The source R code for the answers is as follows:</p>
<p><span class="math display">\[\theta=\int_{0}^{\ 1}\ e^x d x\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>mcesit&lt;-<span class="cf">function</span>(x,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){</span>
<span id="cb7-2"><a href="#cb7-2"></a>u&lt;-<span class="kw">runif</span>(x<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="cf">if</span>(<span class="op">!</span>antithetic)v&lt;-<span class="kw">runif</span>(x<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="cf">else</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  v&lt;-<span class="dv">1</span><span class="op">-</span>u</span>
<span id="cb7-6"><a href="#cb7-6"></a>u&lt;-<span class="kw">c</span>(u,v)</span>
<span id="cb7-7"><a href="#cb7-7"></a>xdf&lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(u))</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a>}</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a>mc1&lt;-<span class="kw">mcesit</span>(<span class="dt">x=</span><span class="fl">1e4</span>)<span class="co">##mc1表示有对偶变量法求出的估计值</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="kw">print</span>(mc1)</span></code></pre></div>
<pre><code>## [1] 1.718076</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>mc2&lt;-<span class="kw">mcesit</span>(<span class="dt">x=</span><span class="fl">1e4</span>,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>)<span class="co">##</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw">print</span>(mc2)<span class="co">##mc2表示有简单蒙特卡罗方法求出的估计值</span></span></code></pre></div>
<pre><code>## [1] 1.713146</code></pre>
<p>mc1 represents the estimator generated by the antithetic variate approach. mc2 represents the estimator generated by the simple Monte Carlo method. The reduction in variance can be estimated by a simulation under both methods, the simple Monte Carlo integration approach and the antithetic variable approach.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>n&lt;-<span class="fl">1e3</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>mc1&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3"></a>mc2&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb11-5"><a href="#cb11-5"></a>  mc1[i]&lt;-<span class="kw">mcesit</span>(<span class="dt">x=</span><span class="fl">1e3</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>  mc2[i]&lt;-<span class="kw">mcesit</span>(<span class="dt">x=</span><span class="fl">1e3</span>,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>}</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">print</span>(<span class="kw">sd</span>(mc1))</span></code></pre></div>
<pre><code>## [1] 0.002787515</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">print</span>(<span class="kw">sd</span>(mc2))</span></code></pre></div>
<pre><code>## [1] 0.01576022</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>cdl&lt;-(<span class="kw">var</span>(mc1)<span class="op">-</span><span class="kw">var</span>(mc2))<span class="op">/</span><span class="kw">var</span>(mc1)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">print</span>(cdl)<span class="co">##cdl表示由使用对偶变量法减少的方差</span></span></code></pre></div>
<pre><code>## [1] -30.96614</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>cdl2&lt;-(<span class="op">-</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">-</span><span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="fl">2.5</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">print</span>(cdl2)<span class="co">##cdl2表示理论上应该减少的方差</span></span></code></pre></div>
<pre><code>## [1] 0.6087914</code></pre>
<p>cdl reprensents the reduction in variance e using the antithetic variate. cdl2 represntes the theoretical value of the precent reduction which can be achieved.</p>
<p><em>3.exercise</em> The source R code for the answers is as follows:</p>
<p>First we can find that <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of $, so for any constant c, <span class="math display">\[
\hat{\theta}_{c}=\ c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}
\]</span> is unbiased for <span class="math inline">\(\theta\)</span>.So the variance of <span class="math inline">\(\hat{\theta}_{c}\)</span> is <span class="math display">\[\operatorname{Var}\left(\hat{\theta}_{2}\right)+c^{2} \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)+2 c \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)\]</span> <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator should be <span class="math display">\[
\ c^{*}=-\frac{\operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)}{\operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)}
\]</span></p>
</div>
<div id="section-3" class="section level2">
<h2>2020-10-20</h2>
<p><em>1.exercise</em></p>
<p>As the question asked,we need to find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are closed to</p>
<p><span class="math inline">\(g(x)\)</span>.The candidates for the improtance functions are: <span class="math display">\[
\begin{aligned}
f_{1}(x)&amp;=\frac{1}{2} e^{-(x-1)/ 2}\quad 1&lt;x&lt;\infty\\
f_{2}(x)&amp;=xe^{-x^{2} / 2+1/2}\quad 1&lt;x&lt;\infty\\
\end{aligned}
\]</span> we can diaplay the plot of importance function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>x&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">005</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>z&lt;-<span class="dv">2</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>f1&lt;-<span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>f2&lt;-<span class="st"> </span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>L&lt;-(x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)<span class="co">##L表示给定的g(x)</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">plot</span>(x,L,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">lwd=</span>z)</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">lines</span>(x,f1,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span>z)</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="kw">lines</span>(x,f2,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span>z)</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;L&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> z, <span class="dt">inset =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>From the picture,we know that the two importance function are closed to the given function and <span class="math inline">\(f_{2}\)</span> is even closer to the given function.Hence, we use two importance functions.</p>
<p>The procedure for using <span class="math inline">\(f_{1}\)</span> as the importance function is shown below：</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>lambda.hat&lt;-<span class="kw">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>se&lt;-<span class="kw">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>mhh&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb20-5"><a href="#cb20-5"></a>HZ&lt;-<span class="cf">function</span>(x){</span>
<span id="cb20-6"><a href="#cb20-6"></a>  (x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>}</span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb20-9"><a href="#cb20-9"></a>x&lt;-<span class="kw">rexp</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span><span class="co">##这里使用importance function f1</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>L&lt;-<span class="cf">function</span>(x){</span>
<span id="cb20-11"><a href="#cb20-11"></a>(<span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="fl">0.5</span>)</span>
<span id="cb20-12"><a href="#cb20-12"></a>}</span>
<span id="cb20-13"><a href="#cb20-13"></a>mhh[i]&lt;-<span class="st"> </span><span class="kw">HZ</span>(x)<span class="op">/</span><span class="kw">L</span>(x)</span>
<span id="cb20-14"><a href="#cb20-14"></a>}</span>
<span id="cb20-15"><a href="#cb20-15"></a>lambda.hat[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(mhh)</span>
<span id="cb20-16"><a href="#cb20-16"></a>se[<span class="dv">1</span>]&lt;-<span class="kw">sd</span>(mhh)</span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="kw">print</span>(lambda.hat)<span class="co">##估计结果</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="kw">print</span>(se)<span class="co">##估计方差</span></span></code></pre></div>
<p>The procedure for using <span class="math inline">\(f_{2}\)</span> as the importance function is shown below：</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>lambda.hat&lt;-<span class="kw">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>se&lt;-<span class="kw">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>AS&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb21-5"><a href="#cb21-5"></a>HZ&lt;-<span class="cf">function</span>(x){</span>
<span id="cb21-6"><a href="#cb21-6"></a>  (x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7"></a>}</span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb21-9"><a href="#cb21-9"></a>u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb21-10"><a href="#cb21-10"></a>x&lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co">##这里使用importance function f2</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>S&lt;-<span class="cf">function</span>(x){</span>
<span id="cb21-12"><a href="#cb21-12"></a>  x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb21-13"><a href="#cb21-13"></a>}</span>
<span id="cb21-14"><a href="#cb21-14"></a>AS[i]&lt;-<span class="kw">HZ</span>(x)<span class="op">/</span><span class="kw">S</span>(x)</span>
<span id="cb21-15"><a href="#cb21-15"></a>}</span>
<span id="cb21-16"><a href="#cb21-16"></a>lambda.hat&lt;-<span class="kw">mean</span>(AS)</span>
<span id="cb21-17"><a href="#cb21-17"></a>se&lt;-<span class="kw">sd</span>(AS)</span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="kw">print</span>(lambda.hat)<span class="co">##估计结果</span></span></code></pre></div>
<pre><code>## [1] 0.3989138</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">print</span>(se)<span class="co">##估计方差</span></span></code></pre></div>
<pre><code>## [1] 0.1221674</code></pre>
<p>As we can see, less variance can be obtained by using <span class="math inline">\(f_{2}\)</span>as the importance function. The source R code for the answers is as follows:</p>
<p><em>2.exercise</em></p>
<p>As the question asks,we should divide the interval (0,1) into five subintervals,</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>a&lt;-<span class="fl">1e4</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>b&lt;-<span class="dv">5</span> <span class="co">##分层数</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>k&lt;-a<span class="op">/</span>b <span class="co">##每层重复次数</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>T2&lt;-<span class="kw">numeric</span>(b)</span>
<span id="cb25-6"><a href="#cb25-6"></a>xesitx&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb25-7"><a href="#cb25-7"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="op">*</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb25-9"><a href="#cb25-9"></a>}</span>
<span id="cb25-10"><a href="#cb25-10"></a></span>
<span id="cb25-11"><a href="#cb25-11"></a>c&lt;-<span class="kw">numeric</span>(b)</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>b)</span>
<span id="cb25-13"><a href="#cb25-13"></a>{</span>
<span id="cb25-14"><a href="#cb25-14"></a>  c[i]=(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">exp</span>((<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>b)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span>b))</span>
<span id="cb25-15"><a href="#cb25-15"></a>}</span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="kw">print</span>(c)</span></code></pre></div>
<pre><code>## [1] 3.487191 4.259265 5.202278 6.354077 7.760887</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb27-2"><a href="#cb27-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(a) <span class="co">#f3</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb27-4"><a href="#cb27-4"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb27-5"><a href="#cb27-5"></a>xesitx[i,<span class="dv">1</span>]=<span class="kw">mean</span>(fg)</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>b) {</span>
<span id="cb27-7"><a href="#cb27-7"></a>  u&lt;-<span class="kw">runif</span>(a<span class="op">/</span>b,(j<span class="dv">-1</span>)<span class="op">/</span>b,j<span class="op">/</span>b)</span>
<span id="cb27-8"><a href="#cb27-8"></a>  x&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>b) <span class="op">-</span><span class="st"> </span>(u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>c[j]))</span>
<span id="cb27-9"><a href="#cb27-9"></a>  T2[j]=<span class="kw">mean</span>( <span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(c[j]<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))</span>
<span id="cb27-10"><a href="#cb27-10"></a>}</span>
<span id="cb27-11"><a href="#cb27-11"></a>xesitx[i,<span class="dv">2</span>]=<span class="kw">sum</span>(T2)</span>
<span id="cb27-12"><a href="#cb27-12"></a>}</span>
<span id="cb27-13"><a href="#cb27-13"></a>xesitx<span class="co">##所得的矩阵</span></span></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.5263198 0.5241500
##  [2,] 0.5253506 0.5242370
##  [3,] 0.5249969 0.5241808
##  [4,] 0.5236098 0.5242101
##  [5,] 0.5251309 0.5241941
##  [6,] 0.5251671 0.5242369
##  [7,] 0.5235398 0.5242032
##  [8,] 0.5240612 0.5242349
##  [9,] 0.5244569 0.5241724
## [10,] 0.5242577 0.5242220
## [11,] 0.5260397 0.5242457
## [12,] 0.5243304 0.5242329
## [13,] 0.5246594 0.5242068
## [14,] 0.5252703 0.5241837
## [15,] 0.5253872 0.5242304
## [16,] 0.5237778 0.5241982
## [17,] 0.5233679 0.5242152
## [18,] 0.5245910 0.5242785
## [19,] 0.5242559 0.5241963
## [20,] 0.5246846 0.5242385
## [21,] 0.5255655 0.5242088
## [22,] 0.5232298 0.5241891
## [23,] 0.5247308 0.5241981
## [24,] 0.5234838 0.5241997
## [25,] 0.5237094 0.5242730
## [26,] 0.5263754 0.5242146
## [27,] 0.5261740 0.5242492
## [28,] 0.5244555 0.5242520
## [29,] 0.5247262 0.5243159
## [30,] 0.5235934 0.5242618</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">apply</span>(xesitx,<span class="dv">2</span>,mean)<span class="co">##估计的均值</span></span></code></pre></div>
<pre><code>## [1] 0.5246433 0.5242210</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">apply</span>(xesitx,<span class="dv">2</span>,var)<span class="co">##估计的方差</span></span></code></pre></div>
<pre><code>## [1] 8.221350e-07 1.220163e-09</code></pre>
<p>From the final results, we can also see that the variance has decreased a lot, the Stratified Importance Sampling methods helps a lot.</p>
<p><em>3.exercise</em></p>
<p>对数正态总体定义:若总体 <span class="math inline">\(X\)</span> 满足 <span class="math inline">\(\ln x \sim N\left(\mu, \sigma^{2}\right),\)</span> 即 <span class="math inline">\(X \sim f(x)=\frac{1}{\sqrt{2 \pi \sigma}} e^{-\frac{\ln (x-\mu)^{2}}{2 \sigma^{2}}}\)</span> 其中 <span class="math inline">\(x&gt;0,-\infty\)</span> <span class="math inline">\(&lt;\mu&lt;\infty, \sigma^{2}\)</span> 为已知.则称 <span class="math inline">\(X\)</span> 为对数正态总体. 设 <span class="math inline">\(X_{1}, X_{2}, \cdots X_{n}\)</span> 为来自对数正态总体 <span class="math inline">\(X\)</span> 的简单随机样本.记 <span class="math display">\[
\overline{\ln x}=\frac{1}{n} \sum_{i=1}^{n} \ln x_{i}
\]</span> 故设 <span class="math inline">\(X_{1}, X_{2}, \cdots X_{n}\)</span> 为来自对数正态总体 <span class="math inline">\(X\)</span> 的简单随机样本,则 <span class="math inline">\((\)</span> i <span class="math inline">\() \overline{\ln x}\)</span> 是 <span class="math inline">\(\mu\)</span> 的充分统计量 (ii) <span class="math inline">\(\frac{\overline{\ln x}-\mu}{\sigma} \sqrt{n} \sim N(0,1)\)</span> 因此其参数<span class="math inline">\(\mu\)</span>的95%的置信区间可以构造为<span class="math display">\[(\overline{\ln x}-1.96se,\overline{\ln x}+1.96se)\]</span> 其中<span class="math display">\[se^2=\frac{1}{n-1}\sum_{i=1}^{n}(ln x_{i}-\overline{\ln x})^2\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mu&lt;-<span class="dv">2</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>beta&lt;-<span class="dv">1</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>m&lt;-<span class="fl">1e4</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>beta.hat1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-6"><a href="#cb33-6"></a>beta.hat2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb33-8"><a href="#cb33-8"></a>x&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb33-9"><a href="#cb33-9"></a>x&lt;-<span class="kw">rlnorm</span>(n,<span class="dv">2</span>,<span class="dv">1</span>)  </span>
<span id="cb33-10"><a href="#cb33-10"></a>y&lt;-<span class="kw">log</span>(x)  </span>
<span id="cb33-11"><a href="#cb33-11"></a>z&lt;-<span class="kw">sum</span>(<span class="kw">log</span>(x))<span class="op">/</span>n</span>
<span id="cb33-12"><a href="#cb33-12"></a>hl&lt;-<span class="kw">var</span>(<span class="kw">log</span>(x))</span>
<span id="cb33-13"><a href="#cb33-13"></a>beta.hat1[i]&lt;-z<span class="fl">-1.96</span><span class="op">*</span><span class="kw">sqrt</span>(hl<span class="op">/</span>n)<span class="co">##置信上限</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>beta.hat2[i]&lt;-z<span class="fl">+1.96</span><span class="op">*</span><span class="kw">sqrt</span>(hl<span class="op">/</span>n)<span class="co">##置信下限</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>}</span>
<span id="cb33-16"><a href="#cb33-16"></a>estib1&lt;-<span class="kw">mean</span>(beta.hat1)</span>
<span id="cb33-17"><a href="#cb33-17"></a>estib2&lt;-<span class="kw">mean</span>(beta.hat2)</span>
<span id="cb33-18"><a href="#cb33-18"></a><span class="kw">print</span>(<span class="kw">c</span>(estib1,estib2))<span class="co">##这是我们求出来的置信区间</span></span></code></pre></div>
<pre><code>## [1] 1.565532 2.431263</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>indictor&lt;-<span class="cf">function</span>(j){</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="cf">if</span>(beta.hat1[i]<span class="op">&lt;=</span><span class="dv">2</span><span class="op">&amp;&amp;</span>beta.hat2[i]<span class="op">&gt;=</span><span class="dv">2</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>  j=j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="cf">else</span>{j=j}</span>
<span id="cb35-6"><a href="#cb35-6"></a>}</span>
<span id="cb35-7"><a href="#cb35-7"></a>  j</span>
<span id="cb35-8"><a href="#cb35-8"></a>}</span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="kw">print</span>(<span class="kw">indictor</span>(<span class="dv">0</span>)<span class="op">/</span>m)<span class="co">##这是我们估计的置信水平</span></span></code></pre></div>
<pre><code>## [1] 0.9357</code></pre>
<p>这是我们假设<span class="math inline">\(\mu\)</span>已知时，所求出的置信区间，可以看见其包含未知参数,以及使用蒙特卡罗方法得到的置信水平的估计。</p>
<p><em>4.exercise</em></p>
<p>根据实例6.4，我们可以了解到</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb37-4"><a href="#cb37-4"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb37-6"><a href="#cb37-6"></a>} )</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.946</code></pre>
<p>使用t-interval时，我们可以知道</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>m&lt;-<span class="dv">20</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>theta.hat1&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb39-5"><a href="#cb39-5"></a>theta.hat2&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb39-7"><a href="#cb39-7"></a>x&lt;-<span class="kw">rchisq</span>(m,<span class="dv">2</span>)</span>
<span id="cb39-8"><a href="#cb39-8"></a>theta.hat1[i]&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dv">19</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">20</span>)<span class="co">##95%的置信区间下限</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>theta.hat2[i]&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dv">19</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">20</span>)<span class="co">##95%的置信区间上限</span></span>
<span id="cb39-10"><a href="#cb39-10"></a>}</span>
<span id="cb39-11"><a href="#cb39-11"></a>indictor&lt;-<span class="cf">function</span>(j){</span>
<span id="cb39-12"><a href="#cb39-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb39-13"><a href="#cb39-13"></a>  <span class="cf">if</span>(theta.hat1[i]<span class="op">&lt;=</span><span class="dv">2</span><span class="op">&amp;&amp;</span>theta.hat2[i]<span class="op">&gt;=</span><span class="dv">2</span>)</span>
<span id="cb39-14"><a href="#cb39-14"></a>  j=j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="cf">else</span>{j=j}</span>
<span id="cb39-16"><a href="#cb39-16"></a>}</span>
<span id="cb39-17"><a href="#cb39-17"></a>  j</span>
<span id="cb39-18"><a href="#cb39-18"></a>}</span>
<span id="cb39-19"><a href="#cb39-19"></a><span class="kw">print</span>(<span class="kw">indictor</span>(<span class="dv">0</span>)<span class="op">/</span>n)</span></code></pre></div>
<pre><code>## [1] 0.9149</code></pre>
<p>从结果可以看出使用t分布去估计置信区间时，其置信水平往往达不到95%的值。</p>
</div>
<div id="section-4" class="section level2">
<h2>2020-10-27</h2>
<p><em>1.exercise</em></p>
<p>As we know that the skewness <span class="math inline">\(\sqrt{\beta}\)</span> of a random variable is defined by <span class="math display">\[
\sqrt{\beta}=\frac{E\left[x-\mu_{x}\right]^{3}}{\sigma_{x}^{3}}
\]</span> Here <span class="math inline">\(\mu_{x}=E\left[x\right]\)</span> and <span class="math inline">\(\sigma_{x}^{2}=\operatorname{Var}{x}.\)</span> A distribution is symmetric if <span class="math inline">\(\sqrt{\beta}=0,\)</span> positively skewed if <span class="math inline">\(\sqrt{\beta}&gt;0,\)</span> and negatively skewed if <span class="math inline">\(\sqrt{\beta}&lt;0\)</span> The sample coefficient of skewness is denoted by <span class="math inline">\(\sqrt{b},\)</span> and defined as $$ =</p>
<p>$$</p>
<p>If the distribution of <span class="math inline">\(X\)</span> is normal, then <span class="math inline">\(\sqrt{b}\)</span> is asymptotically normal with mean 0 and variance <span class="math inline">\(6 / n\)</span>. So we should test the value of <span class="math inline">\(\sqrt{b}\)</span> ,and check if the distribution’s normality.</p>
<p>The hypotheses are <span class="math display">\[
H_{0}:\sqrt{\beta}=0;\quad H_{1}:\sqrt{\beta}\neq 0
\]</span> and the sampling distribution of the skewness statistic is derived under the assumption of normality.</p>
<p>(1)The results of a test of beta distribution are below,p1 means e the power of the skewness test of normality against symmetric Beta(α, α) distributions (here we set a=1)</p>
<p>(2)The results of a test of t(v) are below,p2 means e the power of the skewness test of normality against symmetric t(v) distributions(here we set v=3):</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>m&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>)<span class="co">#sample sizes</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>k&lt;-<span class="kw">qnorm</span>(.<span class="dv">975</span>,<span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(m<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(m<span class="op">+</span><span class="dv">3</span>))))<span class="co">##k denotes the vector of critical values of the normal distribution</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>skew&lt;-<span class="cf">function</span>(x){</span>
<span id="cb41-5"><a href="#cb41-5"></a>  bar1&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb41-6"><a href="#cb41-6"></a>  me1&lt;-<span class="kw">mean</span>((x<span class="op">-</span>bar1)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>  me2&lt;-<span class="kw">mean</span>((x<span class="op">-</span>bar1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="kw">return</span>(me1<span class="op">/</span>(me2)<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb41-9"><a href="#cb41-9"></a>}</span>
<span id="cb41-10"><a href="#cb41-10"></a>p1&lt;-<span class="kw">length</span>(m)</span>
<span id="cb41-11"><a href="#cb41-11"></a>p2&lt;-<span class="kw">length</span>(m)</span>
<span id="cb41-12"><a href="#cb41-12"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>xesits1&lt;-<span class="kw">length</span>(n)</span>
<span id="cb41-14"><a href="#cb41-14"></a>xesits2&lt;-<span class="kw">length</span>(n)</span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(m)){</span>
<span id="cb41-16"><a href="#cb41-16"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb41-17"><a href="#cb41-17"></a>  x&lt;-<span class="kw">rbeta</span>(m[i],<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb41-18"><a href="#cb41-18"></a>  y&lt;-<span class="kw">rt</span>(m[i],<span class="dv">3</span>)<span class="co">##Here we assume v=3</span></span>
<span id="cb41-19"><a href="#cb41-19"></a>  xesits1[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew</span>(x))<span class="op">&gt;=</span>k[i])</span>
<span id="cb41-20"><a href="#cb41-20"></a>  xesits2[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew</span>(y))<span class="op">&gt;=</span>k[i])</span>
<span id="cb41-21"><a href="#cb41-21"></a>  }</span>
<span id="cb41-22"><a href="#cb41-22"></a>  p1[i]&lt;-<span class="kw">mean</span>(xesits1)</span>
<span id="cb41-23"><a href="#cb41-23"></a>  p2[i]&lt;-<span class="kw">mean</span>(xesits2)</span>
<span id="cb41-24"><a href="#cb41-24"></a>}</span>
<span id="cb41-25"><a href="#cb41-25"></a>p1<span class="co">##power of the skewness test of normality against symmetric Beta(α, α) distributions </span></span></code></pre></div>
<pre><code>## [1] 0.0212 0.0059 0.0036 0.0031 0.0018</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>p2<span class="co">##power of the skewness test of normality against symmetric t(v) distributions</span></span></code></pre></div>
<pre><code>## [1] 0.2254 0.3564 0.4309 0.5227 0.6445</code></pre>
<p>The power of the skewness test of normality against symmetric Beta(α, α) distributions is small.Normal distributions are symmetric, and a test for normality based on skewness rejects the hypothesis of normality for large values of <span class="math inline">\(|\sqrt{b}|\)</span>. Compared with beta distribution, t distribution has a larger value of power.</p>
<p><em>2.exercise</em></p>
<p>Here We assume that the samples are from two normal distributions with different variances First we consider the power of the Count Five test.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb45-3"><a href="#cb45-3"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb45-4"><a href="#cb45-4"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb45-5"><a href="#cb45-5"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb45-6"><a href="#cb45-6"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb45-8"><a href="#cb45-8"></a>}</span>
<span id="cb45-9"><a href="#cb45-9"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>x&lt;-<span class="kw">length</span>(m)</span>
<span id="cb45-12"><a href="#cb45-12"></a>y&lt;-<span class="kw">length</span>(m)</span>
<span id="cb45-13"><a href="#cb45-13"></a>m&lt;-<span class="fl">1e4</span></span>
<span id="cb45-14"><a href="#cb45-14"></a>n&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="fl">1e4</span>)<span class="co">## the small, medium, and large sample sizes</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>power&lt;-<span class="kw">length</span>(n)</span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb45-17"><a href="#cb45-17"></a> power[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb45-18"><a href="#cb45-18"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb45-19"><a href="#cb45-19"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb45-21"><a href="#cb45-21"></a>})) </span>
<span id="cb45-22"><a href="#cb45-22"></a>}</span>
<span id="cb45-23"><a href="#cb45-23"></a><span class="kw">print</span>(power)</span></code></pre></div>
<p>Next compute the F test of equal variance, at significance level 0.055.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-2"><a href="#cb46-2"></a>alpha&lt;-<span class="fl">0.055</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>M&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="fl">1e4</span>)<span class="co">## the small, medium, and large sample sizes</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>sigma1&lt;-<span class="dv">1</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>sigma2&lt;-<span class="fl">1.5</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>resit&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb46-8"><a href="#cb46-8"></a>pw3&lt;-<span class="kw">length</span>(M)</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(M)){</span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb46-11"><a href="#cb46-11"></a>Y1&lt;-<span class="kw">rnorm</span>(M[j],<span class="dv">0</span>,sigma1)</span>
<span id="cb46-12"><a href="#cb46-12"></a>Y2&lt;-<span class="kw">rnorm</span>(M[j],<span class="dv">0</span>,sigma2)</span>
<span id="cb46-13"><a href="#cb46-13"></a>res.est&lt;-<span class="kw">var.test</span>(Y1, Y2, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb46-14"><a href="#cb46-14"></a>resit[i]&lt;-<span class="kw">as.integer</span>(res.est<span class="op">$</span>p.value<span class="op">&lt;=</span>alpha)</span>
<span id="cb46-15"><a href="#cb46-15"></a>}</span>
<span id="cb46-16"><a href="#cb46-16"></a>  pw3[j]&lt;-<span class="kw">mean</span>(resit)</span>
<span id="cb46-17"><a href="#cb46-17"></a>}</span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="kw">print</span>(pw3)</span></code></pre></div>
<p>As we can see from the results of the simulation: When the sample size is small, F-test cannot reject the original hypothesis with the same variance When the sample size is moderate, F-test can reject the original hypothesis with the same variance When the sample size is large, the p value of F test is very small. So the number of the sample sizes should be large enough.</p>
<p>From the estimation results, the power value of F test is larger.</p>
<p><em>3.exercise</em></p>
<p>First we consider example 6.8 for Mardia’s multivariate skweness test.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb47-3"><a href="#cb47-3"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>M&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>)</span>
<span id="cb47-6"><a href="#cb47-6"></a>k&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb47-7"><a href="#cb47-7"></a>xskes&lt;-<span class="cf">function</span>(x,y,n){</span>
<span id="cb47-8"><a href="#cb47-8"></a>  z&lt;-<span class="kw">cbind</span>(x,y)</span>
<span id="cb47-9"><a href="#cb47-9"></a>  zbar&lt;-<span class="kw">apply</span>(z,<span class="dv">2</span>,mean)</span>
<span id="cb47-10"><a href="#cb47-10"></a>  iz&lt;-z<span class="op">-</span>zbar</span>
<span id="cb47-11"><a href="#cb47-11"></a>  hatsig&lt;-<span class="kw">solve</span>(<span class="kw">cov</span>(z))</span>
<span id="cb47-12"><a href="#cb47-12"></a>  po&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb47-14"><a href="#cb47-14"></a>    g&lt;-<span class="kw">as.matrix</span>(iz[i,])</span>
<span id="cb47-15"><a href="#cb47-15"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb47-16"><a href="#cb47-16"></a>      f&lt;-<span class="kw">as.matrix</span>(iz[j,])</span>
<span id="cb47-17"><a href="#cb47-17"></a>      po[i,j]&lt;-(<span class="kw">t</span>(g)<span class="op">%*%</span>hatsig<span class="op">%*%</span>f)<span class="op">^</span><span class="dv">3</span></span>
<span id="cb47-18"><a href="#cb47-18"></a>    }</span>
<span id="cb47-19"><a href="#cb47-19"></a>  }</span>
<span id="cb47-20"><a href="#cb47-20"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(po)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb47-21"><a href="#cb47-21"></a>}<span class="co">## 求多元偏度的值</span></span>
<span id="cb47-22"><a href="#cb47-22"></a>p2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(M))</span>
<span id="cb47-23"><a href="#cb47-23"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(M)){</span>
<span id="cb47-24"><a href="#cb47-24"></a>  xesite&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb47-25"><a href="#cb47-25"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb47-26"><a href="#cb47-26"></a>    mean1&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb47-27"><a href="#cb47-27"></a>    sigma4&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb47-28"><a href="#cb47-28"></a>    hats&lt;-<span class="kw">mvrnorm</span>(M[i],mean1,sigma4)<span class="co">##生成二维独立正态随机变量</span></span>
<span id="cb47-29"><a href="#cb47-29"></a>    xhat&lt;-<span class="kw">as.matrix</span>(hats)</span>
<span id="cb47-30"><a href="#cb47-30"></a>    x&lt;-xhat[,<span class="dv">1</span>]</span>
<span id="cb47-31"><a href="#cb47-31"></a>    y&lt;-xhat[,<span class="dv">2</span>]</span>
<span id="cb47-32"><a href="#cb47-32"></a>    xesite[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(M[i]<span class="op">*</span><span class="kw">xskes</span>(x,y,M[i])<span class="op">/</span><span class="dv">6</span>)<span class="op">&gt;=</span>k)</span>
<span id="cb47-33"><a href="#cb47-33"></a>  }</span>
<span id="cb47-34"><a href="#cb47-34"></a>  p2[i]&lt;-<span class="kw">mean</span>(xesite)</span>
<span id="cb47-35"><a href="#cb47-35"></a>}</span>
<span id="cb47-36"><a href="#cb47-36"></a>p2</span></code></pre></div>
<p>repeat the example 6.10</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>xskes&lt;-<span class="cf">function</span>(z,n){</span>
<span id="cb48-3"><a href="#cb48-3"></a>  zbar&lt;-<span class="kw">apply</span>(z,<span class="dv">2</span>,mean)</span>
<span id="cb48-4"><a href="#cb48-4"></a>  iz&lt;-z<span class="op">-</span>zbar</span>
<span id="cb48-5"><a href="#cb48-5"></a>  hatsig&lt;-<span class="kw">solve</span>(<span class="kw">cov</span>(z))</span>
<span id="cb48-6"><a href="#cb48-6"></a>  sum&lt;-<span class="dv">0</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb48-8"><a href="#cb48-8"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb48-9"><a href="#cb48-9"></a>      sum=sum<span class="op">+</span>(<span class="kw">t</span>(iz[i,])<span class="op">%*%</span>hatsig<span class="op">%*%</span>iz[j,])<span class="op">^</span><span class="dv">3</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>    }</span>
<span id="cb48-11"><a href="#cb48-11"></a>  }</span>
<span id="cb48-12"><a href="#cb48-12"></a>  <span class="kw">return</span>(sum<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb48-13"><a href="#cb48-13"></a>}<span class="co">##计算偏度的函数</span></span>
<span id="cb48-14"><a href="#cb48-14"></a><span class="kw">library</span>(MASS)</span>
<span id="cb48-15"><a href="#cb48-15"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb48-16"><a href="#cb48-16"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>e&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,.<span class="dv">15</span>,.<span class="dv">01</span>),<span class="kw">seq</span>(.<span class="dv">15</span>,<span class="dv">1</span>,.<span class="dv">05</span>))</span>
<span id="cb48-18"><a href="#cb48-18"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb48-19"><a href="#cb48-19"></a>h&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb48-20"><a href="#cb48-20"></a>pwr1&lt;-<span class="kw">length</span>(e)</span>
<span id="cb48-21"><a href="#cb48-21"></a>xhat&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb48-22"><a href="#cb48-22"></a>sigma9&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb48-23"><a href="#cb48-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(e)) {</span>
<span id="cb48-24"><a href="#cb48-24"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb48-25"><a href="#cb48-25"></a>    sigma&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e[i], e[i]))</span>
<span id="cb48-26"><a href="#cb48-26"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) </span>
<span id="cb48-27"><a href="#cb48-27"></a>    { xhat[k,]&lt;-<span class="kw">mvrnorm</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma[k]<span class="op">*</span><span class="kw">diag</span>(<span class="dv">2</span>))}</span>
<span id="cb48-28"><a href="#cb48-28"></a>    sigma9[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">xskes</span>(xhat,n)<span class="op">*</span><span class="dv">5</span>) <span class="op">&gt;=</span><span class="st"> </span>h)</span>
<span id="cb48-29"><a href="#cb48-29"></a>    }</span>
<span id="cb48-30"><a href="#cb48-30"></a>  pwr1[i]&lt;-<span class="kw">mean</span>(sigma9)</span>
<span id="cb48-31"><a href="#cb48-31"></a>}</span>
<span id="cb48-32"><a href="#cb48-32"></a><span class="kw">print</span>(pwr1)</span>
<span id="cb48-33"><a href="#cb48-33"></a><span class="co">##图像</span></span>
<span id="cb48-34"><a href="#cb48-34"></a><span class="kw">plot</span>(e, pwr1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb48-35"><a href="#cb48-35"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb48-36"><a href="#cb48-36"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-37"><a href="#cb48-37"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr1 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr1) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb48-38"><a href="#cb48-38"></a><span class="kw">lines</span>(e, pwr1<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-39"><a href="#cb48-39"></a><span class="kw">lines</span>(e, pwr1<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="section-5" class="section level2">
<h2>2020-11-03</h2>
<p><em>1.exercise</em></p>
<p>Example7.2 The law school data set law in the bootstrap package is from Efron and Tibshirani. The data frame contains LSAT (average score on law school admission test score) and GPA (average undergraduate grade-point average) for 15 law schools.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a>x&lt;-law<span class="op">$</span>LSAT</span>
<span id="cb49-4"><a href="#cb49-4"></a>y&lt;-law<span class="op">$</span>GPA</span>
<span id="cb49-5"><a href="#cb49-5"></a>theta.hat&lt;-<span class="kw">cor</span>(x,y)</span>
<span id="cb49-6"><a href="#cb49-6"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb49-7"><a href="#cb49-7"></a>theta.jack&lt;-<span class="kw">nrow</span>(n)</span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb49-9"><a href="#cb49-9"></a>  theta.jack[i]&lt;-<span class="kw">cor</span>(x[<span class="op">-</span>i],y[<span class="op">-</span>i])</span>
<span id="cb49-10"><a href="#cb49-10"></a>}</span>
<span id="cb49-11"><a href="#cb49-11"></a>bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb49-12"><a href="#cb49-12"></a>se&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span></span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="st">  </span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb49-14"><a href="#cb49-14"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">bias=</span>bias,<span class="dt">se=</span>se))</span></code></pre></div>
<pre><code>## $bias
## [1] -0.006473623
## 
## $se
## [1] 0.1425186</code></pre>
<p><em>2.exercise</em></p>
<p>(1)Refer to exercise 7.4. Obtain the MLE of the hazard rate λ and use bootstrap to estimate the bias and standard error of the estimate. The hazard rate <span class="math inline">\(\lambda\)</span> are estimated by means of MLE ( maximum likelihood estimation). Probability density function of exponential distribution: <span class="math display">\[
f(x, \lambda)=\left\{\begin{array}{ll}\lambda e^{-\lambda x}, &amp; x&gt;0 \\ 0 &amp; , x&lt;0\end{array}\right.
\]</span></p>
<p>Given independent and identically distributed samples: <span class="math inline">\(\boldsymbol{x}=\left(\boldsymbol{x}_{\mathbf{1}}, \boldsymbol{x}_{\mathbf{2}}, \cdots, \boldsymbol{x}_{\mathbf{n}}\right)\)</span>,<span class="math inline">\(\quad \boldsymbol{\lambda}\)</span> ’s likelihood function: <span class="math display">\[
L\boldsymbol(\lambda)=\prod_{i=1}^{n}\lambda e^{-\lambda x_{i}}=\lambda^{n} e^{-\lambda \sum_{i=1}^{n}x_{i}}=\lambda^{n} e^{-\lambda n\bar{x}}
\]</span></p>
<p>so the MLE of the hazard rate λ are as follow: <span class="math display">\[\hat{\lambda}=\frac{1}{\bar{x}}\]</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">data</span>(aircondit,<span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a>y&lt;-<span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb51-4"><a href="#cb51-4"></a>x&lt;-<span class="kw">mean</span>(y)</span>
<span id="cb51-5"><a href="#cb51-5"></a>lambda.hat&lt;-<span class="dv">1</span><span class="op">/</span>x</span>
<span id="cb51-6"><a href="#cb51-6"></a>n&lt;-<span class="kw">nrow</span>(aircondit)</span>
<span id="cb51-7"><a href="#cb51-7"></a>B&lt;-<span class="dv">200</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>x1&lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb51-9"><a href="#cb51-9"></a>lambda1&lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb51-10"><a href="#cb51-10"></a></span>
<span id="cb51-11"><a href="#cb51-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</span>
<span id="cb51-12"><a href="#cb51-12"></a>  i&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb51-13"><a href="#cb51-13"></a>  x1[i]&lt;-<span class="kw">mean</span>(y[i])</span>
<span id="cb51-14"><a href="#cb51-14"></a>  lambda1[i]&lt;-<span class="dv">1</span><span class="op">/</span>x1[i]</span>
<span id="cb51-15"><a href="#cb51-15"></a>}</span>
<span id="cb51-16"><a href="#cb51-16"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">lambda.hat=</span>lambda.hat,<span class="dt">sd=</span><span class="kw">sd</span>(lambda1),<span class="dt">bias=</span><span class="kw">mean</span>(lambda1<span class="op">-</span>lambda.hat)))</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods.</li>
</ol>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">data</span>(aircondit, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb52-3"><a href="#cb52-3"></a>lambda.boot&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="kw">mean</span>(x[i,])</span>
<span id="cb52-5"><a href="#cb52-5"></a>}</span>
<span id="cb52-6"><a href="#cb52-6"></a>x&lt;-<span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb52-7"><a href="#cb52-7"></a>boot.lambda&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic =</span> lambda.boot,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="kw">print</span>(boot.lambda)</span>
<span id="cb52-9"><a href="#cb52-9"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.lambda,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Compare the intervals and explain why they may differ.</li>
</ol>
<p>According to the results of the intervals, Bca methods get the longest intervals,not so much precision. (1)The standard normal bootstrap confidence interval is the simplest approach, but not necessarily the best.This interval is easy to compute, but we have made several assumptions. To apply the normal distribution, we assume that the distribution of <span class="math inline">\(\hat{\theta}\)</span>,n and the sample size is large. (2) The basic bootstrap confidence interval transforms the distribution of the replicates by subtracting the observed statistic. The quantiles of the transformed sample are used to determine the confidence limits. (3) A bootstrap percentile interval uses the empirical distribution of the bootstrap replicates as the reference distribution. The quantiles of the empirical distribution are estimators of the quantiles of the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span>, so that these (random) quantiles may match the true distribution better when the distribution of <span class="math inline">\(\hat{\theta}\)</span> is not normal. (4) Bca methods get the longest intervals,not so much precision.</p>
<p><em>3.exercise</em></p>
<p>Exercise 7.7 Efron and Tibshirani discuss the following example. The five-dimensional scores data have a <span class="math inline">\(5 \times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_{1}&gt;\cdots&gt;\lambda_{5}\)</span>. In principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_{1}}{\sum_{j=1}^{5} \lambda_{j}}
\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma},\)</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the <span class="math inline">\(\mathrm{MLE}\)</span> of <span class="math inline">\(\Sigma\)</span> Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}
\]</span> Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>sigma1&lt;-<span class="kw">cov</span>(scor)</span>
<span id="cb53-3"><a href="#cb53-3"></a>ev&lt;-<span class="kw">eigen</span>(sigma1)</span>
<span id="cb53-4"><a href="#cb53-4"></a>lambda1&lt;-ev<span class="op">$</span>values[<span class="dv">1</span>]</span>
<span id="cb53-5"><a href="#cb53-5"></a>theta.hat&lt;-lambda1<span class="op">/</span><span class="kw">sum</span>(ev<span class="op">$</span>values)</span>
<span id="cb53-6"><a href="#cb53-6"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb53-7"><a href="#cb53-7"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb53-9"><a href="#cb53-9"></a>sigma1&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</span>
<span id="cb53-10"><a href="#cb53-10"></a>ev&lt;-<span class="kw">eigen</span>(sigma1)</span>
<span id="cb53-11"><a href="#cb53-11"></a>lambda1&lt;-ev<span class="op">$</span>values[<span class="dv">1</span>]</span>
<span id="cb53-12"><a href="#cb53-12"></a>theta.jack[i] &lt;-lambda1<span class="op">/</span><span class="kw">sum</span>(ev<span class="op">$</span>values)</span>
<span id="cb53-13"><a href="#cb53-13"></a>}</span>
<span id="cb53-14"><a href="#cb53-14"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb53-15"><a href="#cb53-15"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span></span>
<span id="cb53-16"><a href="#cb53-16"></a><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb53-17"><a href="#cb53-17"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">bias=</span>bias,<span class="dt">se=</span>se))</span></code></pre></div>
<pre><code>## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<p><em>4.exercise</em></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">data</span>(ironslag,<span class="dt">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>n&lt;-<span class="kw">length</span>(ironslag<span class="op">$</span>magnetic)</span>
<span id="cb55-3"><a href="#cb55-3"></a>m&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>n<span class="op">/</span><span class="dv">2</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>mt&lt;-<span class="kw">as.matrix</span>(ironslag<span class="op">$</span>magnetic)</span>
<span id="cb55-5"><a href="#cb55-5"></a>ct&lt;-<span class="kw">as.matrix</span>(ironslag<span class="op">$</span>chemical)</span>
<span id="cb55-6"><a href="#cb55-6"></a>theta1.hat&lt;-theta2.hat&lt;-theta3.hat&lt;-theta4.hat&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>m,<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb55-7"><a href="#cb55-7"></a>l&lt;-<span class="dv">1</span></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb55-9"><a href="#cb55-9"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb55-10"><a href="#cb55-10"></a>    <span class="cf">if</span>(i<span class="op">!=</span>j<span class="op">&amp;&amp;</span>i<span class="op">&lt;</span>j){</span>
<span id="cb55-11"><a href="#cb55-11"></a>    yt&lt;-mt[<span class="op">-</span><span class="kw">c</span>(i,j),]</span>
<span id="cb55-12"><a href="#cb55-12"></a>    xt&lt;-ct[<span class="op">-</span><span class="kw">c</span>(i,j),]</span>
<span id="cb55-13"><a href="#cb55-13"></a>    </span>
<span id="cb55-14"><a href="#cb55-14"></a>    L1&lt;-<span class="kw">lm</span>(yt <span class="op">~</span><span class="st"> </span>xt)</span>
<span id="cb55-15"><a href="#cb55-15"></a>    y1.hat1&lt;-L1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>ironslag<span class="op">$</span>chemical[i]</span>
<span id="cb55-16"><a href="#cb55-16"></a>    y2.hat1&lt;-L1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>ironslag<span class="op">$</span>chemical[j]</span>
<span id="cb55-17"><a href="#cb55-17"></a>    theta1.hat[l,]&lt;-(ironslag<span class="op">$</span>magnetic[i]<span class="op">-</span>y1.hat1)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(ironslag<span class="op">$</span>magnetic[j]<span class="op">-</span>y2.hat1)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-18"><a href="#cb55-18"></a>        </span>
<span id="cb55-19"><a href="#cb55-19"></a>    L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(yt <span class="op">~</span><span class="st"> </span>xt <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(xt<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb55-20"><a href="#cb55-20"></a>    y1.hat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[i] <span class="op">+</span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-21"><a href="#cb55-21"></a>    y2.hat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[j] <span class="op">+</span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-22"><a href="#cb55-22"></a>    theta2.hat[l,] &lt;-<span class="st"> </span>(ironslag<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>y1.hat2)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(ironslag<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>y2.hat2)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-23"><a href="#cb55-23"></a>    </span>
<span id="cb55-24"><a href="#cb55-24"></a>    L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(yt) <span class="op">~</span><span class="st"> </span>xt)</span>
<span id="cb55-25"><a href="#cb55-25"></a>    logy1.hat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[i]</span>
<span id="cb55-26"><a href="#cb55-26"></a>    logy2.hat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>ironslag<span class="op">$</span>chemical[j]</span>
<span id="cb55-27"><a href="#cb55-27"></a>     y1.hat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logy1.hat3)</span>
<span id="cb55-28"><a href="#cb55-28"></a>     y2.hat3&lt;-<span class="kw">exp</span>(logy2.hat3)</span>
<span id="cb55-29"><a href="#cb55-29"></a>    theta3.hat[l,]&lt;-<span class="st"> </span>(ironslag<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>y1.hat3)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(ironslag<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>y2.hat3)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-30"><a href="#cb55-30"></a>    </span>
<span id="cb55-31"><a href="#cb55-31"></a>    L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(yt) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(xt))</span>
<span id="cb55-32"><a href="#cb55-32"></a>    logy1.hat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(ironslag<span class="op">$</span>chemical[i])</span>
<span id="cb55-33"><a href="#cb55-33"></a>    logy2.hat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(ironslag<span class="op">$</span>chemical[j])</span>
<span id="cb55-34"><a href="#cb55-34"></a>    y1.hat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logy1.hat4)</span>
<span id="cb55-35"><a href="#cb55-35"></a>    y2.hat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logy2.hat4)</span>
<span id="cb55-36"><a href="#cb55-36"></a>    theta4.hat[l,]&lt;-<span class="st"> </span>(ironslag<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>y1.hat4)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(ironslag<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>y2.hat4)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb55-37"><a href="#cb55-37"></a>    </span>
<span id="cb55-38"><a href="#cb55-38"></a>    <span class="cf">if</span>(l<span class="op">&lt;=</span>m<span class="dv">-1</span>) l=l<span class="op">+</span><span class="dv">1</span> <span class="cf">else</span>(<span class="cf">break</span>)</span>
<span id="cb55-39"><a href="#cb55-39"></a>    }</span>
<span id="cb55-40"><a href="#cb55-40"></a>    </span>
<span id="cb55-41"><a href="#cb55-41"></a>  }</span>
<span id="cb55-42"><a href="#cb55-42"></a>}</span>
<span id="cb55-43"><a href="#cb55-43"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">se1=</span><span class="kw">sum</span>(theta1.hat)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m),<span class="dt">se2=</span><span class="kw">sum</span>(theta2.hat)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m),<span class="dt">se3=</span><span class="kw">sum</span>(theta3.hat)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m),<span class="dt">se4=</span><span class="kw">sum</span>(theta4.hat)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m)))</span></code></pre></div>
<pre><code>## $se1
## [1] 19.57227
## 
## $se2
## [1] 17.87018
## 
## $se3
## [1] 18.45491
## 
## $se4
## [1] 20.46718</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">data</span>(<span class="st">&quot;ironslag&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>model2&lt;-<span class="kw">lm</span>(ironslag<span class="op">$</span>magnetic<span class="op">~</span>ironslag<span class="op">$</span>chemical<span class="op">+</span><span class="kw">I</span>(ironslag<span class="op">$</span>chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb57-3"><a href="#cb57-3"></a>model2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ironslag$magnetic ~ ironslag$chemical + I(ironslag$chemical^2))
## 
## Coefficients:
##            (Intercept)       ironslag$chemical  I(ironslag$chemical^2)  
##               24.49262                -1.39334                 0.05452</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math display">\[
\hat{Y}=24.49262-1.39334*X+0.05452*X^2
\]</span></p>
</div>
<div id="section-6" class="section level2">
<h2>2020-11-10</h2>
<p><em>1.exercise</em></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>mu1&lt;-mu2&lt;-<span class="dv">0</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>sigma1&lt;-sigma2&lt;-<span class="dv">1</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>outx1&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb59-8"><a href="#cb59-8"></a>outy1&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb59-9"><a href="#cb59-9"></a>m&lt;-<span class="dv">200</span></span>
<span id="cb59-10"><a href="#cb59-10"></a>P&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb59-12"><a href="#cb59-12"></a>x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb59-13"><a href="#cb59-13"></a>y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb59-14"><a href="#cb59-14"></a>z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb59-15"><a href="#cb59-15"></a>D&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb59-16"><a href="#cb59-16"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb59-17"><a href="#cb59-17"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb59-18"><a href="#cb59-18"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb59-19"><a href="#cb59-19"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb59-20"><a href="#cb59-20"></a>D0&lt;-<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))</span>
<span id="cb59-21"><a href="#cb59-21"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb59-22"><a href="#cb59-22"></a>  k&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,<span class="dt">size =</span> <span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb59-23"><a href="#cb59-23"></a>  x1&lt;-z[k]<span class="op">-</span><span class="kw">mean</span>(z[k])</span>
<span id="cb59-24"><a href="#cb59-24"></a>  y1&lt;-z[<span class="op">-</span>k]<span class="op">-</span><span class="kw">mean</span>(z[<span class="op">-</span>k])</span>
<span id="cb59-25"><a href="#cb59-25"></a>  outx1[i]&lt;-<span class="st"> </span><span class="kw">sum</span>(x1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y1)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y1))</span>
<span id="cb59-26"><a href="#cb59-26"></a>  outy1[i]&lt;-<span class="st"> </span><span class="kw">sum</span>(y1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x1)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x1)) </span>
<span id="cb59-27"><a href="#cb59-27"></a>  D[i]=<span class="kw">max</span>(<span class="kw">c</span>(outx1[i],outy1[i]))</span>
<span id="cb59-28"><a href="#cb59-28"></a>}</span>
<span id="cb59-29"><a href="#cb59-29"></a>P[j]&lt;-<span class="kw">mean</span>(<span class="kw">c</span>(D0,D)<span class="op">&gt;=</span>D0) </span>
<span id="cb59-30"><a href="#cb59-30"></a>}</span>
<span id="cb59-31"><a href="#cb59-31"></a><span class="kw">mean</span>(P)</span></code></pre></div>
<p><em>2.exercise</em></p>
<p>1.Unequal variances and equal expectations.<span class="math inline">\(X\sim N(0.3,1.5^2)\)</span>,<span class="math inline">\(Y\sim N(0.3,1)\)</span></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb60-5"><a href="#cb60-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb60-6"><a href="#cb60-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb60-8"><a href="#cb60-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb60-9"><a href="#cb60-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb60-11"><a href="#cb60-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb60-12"><a href="#cb60-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb60-13"><a href="#cb60-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb60-14"><a href="#cb60-14"></a>}</span>
<span id="cb60-15"><a href="#cb60-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb60-16"><a href="#cb60-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb60-17"><a href="#cb60-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb60-19"><a href="#cb60-19"></a>mu&lt;-<span class="fl">0.3</span></span>
<span id="cb60-20"><a href="#cb60-20"></a>n1&lt;-<span class="dv">50</span></span>
<span id="cb60-21"><a href="#cb60-21"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb60-22"><a href="#cb60-22"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb60-23"><a href="#cb60-23"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb60-24"><a href="#cb60-24"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb60-25"><a href="#cb60-25"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb60-26"><a href="#cb60-26"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb60-27"><a href="#cb60-27"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb60-28"><a href="#cb60-28"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb60-29"><a href="#cb60-29"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb60-30"><a href="#cb60-30"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb60-31"><a href="#cb60-31"></a>}</span>
<span id="cb60-32"><a href="#cb60-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb60-33"><a href="#cb60-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb60-34"><a href="#cb60-34"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb60-35"><a href="#cb60-35"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu));</span>
<span id="cb60-36"><a href="#cb60-36"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb60-37"><a href="#cb60-37"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb60-38"><a href="#cb60-38"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb60-39"><a href="#cb60-39"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb60-40"><a href="#cb60-40"></a>}</span>
<span id="cb60-41"><a href="#cb60-41"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb60-42"><a href="#cb60-42"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb60-43"><a href="#cb60-43"></a>pow1</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations.<span class="math inline">\(X\sim N(0.3,1.5^2)\)</span>,<span class="math inline">\(Y\sim N(0.5,1)\)</span>.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb61-5"><a href="#cb61-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb61-6"><a href="#cb61-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb61-8"><a href="#cb61-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb61-9"><a href="#cb61-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb61-11"><a href="#cb61-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb61-12"><a href="#cb61-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb61-13"><a href="#cb61-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb61-14"><a href="#cb61-14"></a>}</span>
<span id="cb61-15"><a href="#cb61-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-16"><a href="#cb61-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb61-17"><a href="#cb61-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb61-18"><a href="#cb61-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb61-19"><a href="#cb61-19"></a>mu&lt;-<span class="fl">0.3</span></span>
<span id="cb61-20"><a href="#cb61-20"></a>mu1&lt;-<span class="fl">0.5</span></span>
<span id="cb61-21"><a href="#cb61-21"></a>n1&lt;-<span class="dv">50</span></span>
<span id="cb61-22"><a href="#cb61-22"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb61-23"><a href="#cb61-23"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb61-24"><a href="#cb61-24"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb61-25"><a href="#cb61-25"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb61-26"><a href="#cb61-26"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb61-27"><a href="#cb61-27"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb61-28"><a href="#cb61-28"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb61-29"><a href="#cb61-29"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb61-30"><a href="#cb61-30"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb61-31"><a href="#cb61-31"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb61-32"><a href="#cb61-32"></a>}</span>
<span id="cb61-33"><a href="#cb61-33"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-34"><a href="#cb61-34"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb61-35"><a href="#cb61-35"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean=</span>mu1,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb61-36"><a href="#cb61-36"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">1</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">1</span>));</span>
<span id="cb61-37"><a href="#cb61-37"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb61-38"><a href="#cb61-38"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb61-39"><a href="#cb61-39"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb61-40"><a href="#cb61-40"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb61-41"><a href="#cb61-41"></a>}</span>
<span id="cb61-42"><a href="#cb61-42"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb61-43"><a href="#cb61-43"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb61-44"><a href="#cb61-44"></a>pow2</span></code></pre></div>
<p>3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) (a)<span class="math inline">\(X\sim t(1)\)</span>,the cdf of <span class="math inline">\(Y\)</span> is <span class="math inline">\(F(y)=0.8*\phi(y;0,1)+0.2*\phi(y;0,100)\)</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb62-5"><a href="#cb62-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb62-6"><a href="#cb62-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb62-8"><a href="#cb62-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb62-9"><a href="#cb62-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb62-10"><a href="#cb62-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-11"><a href="#cb62-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-12"><a href="#cb62-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb62-13"><a href="#cb62-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb62-14"><a href="#cb62-14"></a>}</span>
<span id="cb62-15"><a href="#cb62-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-16"><a href="#cb62-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb62-17"><a href="#cb62-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb62-18"><a href="#cb62-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb62-19"><a href="#cb62-19"></a>p1&lt;-<span class="fl">0.8</span></span>
<span id="cb62-20"><a href="#cb62-20"></a>n1&lt;-<span class="dv">50</span></span>
<span id="cb62-21"><a href="#cb62-21"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb62-22"><a href="#cb62-22"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb62-23"><a href="#cb62-23"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb62-24"><a href="#cb62-24"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb62-25"><a href="#cb62-25"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb62-26"><a href="#cb62-26"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb62-27"><a href="#cb62-27"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb62-28"><a href="#cb62-28"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb62-29"><a href="#cb62-29"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb62-30"><a href="#cb62-30"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb62-31"><a href="#cb62-31"></a>}</span>
<span id="cb62-32"><a href="#cb62-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb62-33"><a href="#cb62-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb62-34"><a href="#cb62-34"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb62-35"><a href="#cb62-35"></a>sigma&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">size =</span> n2,</span>
<span id="cb62-36"><a href="#cb62-36"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p1, <span class="dv">1</span><span class="op">-</span>p1))</span>
<span id="cb62-37"><a href="#cb62-37"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma));</span>
<span id="cb62-38"><a href="#cb62-38"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb62-39"><a href="#cb62-39"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb62-40"><a href="#cb62-40"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb62-41"><a href="#cb62-41"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb62-42"><a href="#cb62-42"></a>}</span>
<span id="cb62-43"><a href="#cb62-43"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb62-44"><a href="#cb62-44"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb62-45"><a href="#cb62-45"></a>pow3</span></code></pre></div>
<p>(b)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution).<span class="math inline">\(X\sim t(1)\)</span>,<span class="math inline">\(Y\sim t(2)\)</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb63-5"><a href="#cb63-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb63-6"><a href="#cb63-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb63-7"><a href="#cb63-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb63-8"><a href="#cb63-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb63-9"><a href="#cb63-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb63-11"><a href="#cb63-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb63-12"><a href="#cb63-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb63-13"><a href="#cb63-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb63-14"><a href="#cb63-14"></a>}</span>
<span id="cb63-15"><a href="#cb63-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-16"><a href="#cb63-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb63-17"><a href="#cb63-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb63-18"><a href="#cb63-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb63-19"><a href="#cb63-19"></a>p1&lt;-<span class="fl">0.8</span></span>
<span id="cb63-20"><a href="#cb63-20"></a>n1&lt;-<span class="dv">50</span></span>
<span id="cb63-21"><a href="#cb63-21"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb63-22"><a href="#cb63-22"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb63-23"><a href="#cb63-23"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb63-24"><a href="#cb63-24"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb63-25"><a href="#cb63-25"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb63-26"><a href="#cb63-26"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb63-27"><a href="#cb63-27"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb63-28"><a href="#cb63-28"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb63-29"><a href="#cb63-29"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb63-30"><a href="#cb63-30"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb63-31"><a href="#cb63-31"></a>}</span>
<span id="cb63-32"><a href="#cb63-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb63-33"><a href="#cb63-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-34"><a href="#cb63-34"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb63-35"><a href="#cb63-35"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">2</span>),<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">2</span>));</span>
<span id="cb63-36"><a href="#cb63-36"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-37"><a href="#cb63-37"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-38"><a href="#cb63-38"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-39"><a href="#cb63-39"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-40"><a href="#cb63-40"></a>}</span>
<span id="cb63-41"><a href="#cb63-41"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb63-42"><a href="#cb63-42"></a>pow6 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb63-43"><a href="#cb63-43"></a>pow6</span></code></pre></div>
<p>(C)Non-normal distributions: bimodel distribution (mixture of two normal distributions) $F(X)=0.9(0;1)+0.1(0;4) <span class="math inline">\(,\)</span>F(Y)=0.8(0;1)+0.2(0;9) $</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb64-5"><a href="#cb64-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb64-6"><a href="#cb64-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb64-8"><a href="#cb64-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb64-9"><a href="#cb64-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb64-11"><a href="#cb64-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb64-12"><a href="#cb64-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb64-13"><a href="#cb64-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb64-14"><a href="#cb64-14"></a>}</span>
<span id="cb64-15"><a href="#cb64-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-16"><a href="#cb64-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb64-17"><a href="#cb64-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb64-18"><a href="#cb64-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb64-19"><a href="#cb64-19"></a>p1&lt;-<span class="fl">0.8</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>p2&lt;-<span class="fl">0.9</span></span>
<span id="cb64-21"><a href="#cb64-21"></a>n1&lt;-<span class="dv">50</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>n2&lt;-<span class="dv">50</span></span>
<span id="cb64-23"><a href="#cb64-23"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb64-24"><a href="#cb64-24"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb64-25"><a href="#cb64-25"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb64-26"><a href="#cb64-26"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb64-27"><a href="#cb64-27"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb64-28"><a href="#cb64-28"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb64-29"><a href="#cb64-29"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb64-30"><a href="#cb64-30"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb64-31"><a href="#cb64-31"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb64-32"><a href="#cb64-32"></a>}</span>
<span id="cb64-33"><a href="#cb64-33"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb64-34"><a href="#cb64-34"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-35"><a href="#cb64-35"></a>sigma&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">size =</span> n2,</span>
<span id="cb64-36"><a href="#cb64-36"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p1, <span class="dv">1</span><span class="op">-</span>p1))</span>
<span id="cb64-37"><a href="#cb64-37"></a>sigma1&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">size =</span> n2,</span>
<span id="cb64-38"><a href="#cb64-38"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p2, <span class="dv">1</span><span class="op">-</span>p2))</span>
<span id="cb64-39"><a href="#cb64-39"></a>x &lt;-<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n1,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma1),<span class="kw">rnorm</span>(n1,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma1));</span>
<span id="cb64-40"><a href="#cb64-40"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma));</span>
<span id="cb64-41"><a href="#cb64-41"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb64-42"><a href="#cb64-42"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb64-43"><a href="#cb64-43"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb64-44"><a href="#cb64-44"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb64-45"><a href="#cb64-45"></a>}</span>
<span id="cb64-46"><a href="#cb64-46"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb64-47"><a href="#cb64-47"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb64-48"><a href="#cb64-48"></a>pow3</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls).<span class="math inline">\(X\sim N(0.3,1)\quad(n1=10)\)</span>,<span class="math inline">\(Y\sim N(0.3,1) \quad(n2=100)\)</span></li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb65-5"><a href="#cb65-5"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb65-6"><a href="#cb65-6"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb65-8"><a href="#cb65-8"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb65-9"><a href="#cb65-9"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-11"><a href="#cb65-11"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-12"><a href="#cb65-12"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb65-13"><a href="#cb65-13"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb65-14"><a href="#cb65-14"></a>}</span>
<span id="cb65-15"><a href="#cb65-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb65-16"><a href="#cb65-16"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb65-17"><a href="#cb65-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb65-18"><a href="#cb65-18"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>mu&lt;-<span class="fl">0.3</span></span>
<span id="cb65-20"><a href="#cb65-20"></a>n1&lt;-<span class="dv">10</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>n2&lt;-<span class="dv">100</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb65-23"><a href="#cb65-23"></a>n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb65-24"><a href="#cb65-24"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb65-25"><a href="#cb65-25"></a>eqdist.nn&lt;-<span class="cf">function</span>(n,sizes,k){</span>
<span id="cb65-26"><a href="#cb65-26"></a>  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb65-27"><a href="#cb65-27"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb65-28"><a href="#cb65-28"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb65-29"><a href="#cb65-29"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb65-30"><a href="#cb65-30"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb65-31"><a href="#cb65-31"></a>}</span>
<span id="cb65-32"><a href="#cb65-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb65-33"><a href="#cb65-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb65-34"><a href="#cb65-34"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb65-35"><a href="#cb65-35"></a>y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">1</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu,<span class="dt">sd=</span><span class="dv">1</span>));</span>
<span id="cb65-36"><a href="#cb65-36"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb65-37"><a href="#cb65-37"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb65-38"><a href="#cb65-38"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb65-39"><a href="#cb65-39"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb65-40"><a href="#cb65-40"></a>}</span>
<span id="cb65-41"><a href="#cb65-41"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb65-42"><a href="#cb65-42"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb65-43"><a href="#cb65-43"></a>pow4</span></code></pre></div>
<p>As We can see from the results,Ball could be more powerful for non-location family distribution (e.g., the variances are different) Energy test and Ball test are generally more powerful than nearest NN test, but the former two cannot uniformly each other.</p>
</div>
<div id="section-7" class="section level2">
<h2>2020-11-17</h2>
<p><em>1.exercise</em></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">library</span>(kedd)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;kedd&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>n=<span class="dv">1000</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>lambda=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>),<span class="dt">nrow=</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a>P=<span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>)</span>
<span id="cb68-4"><a href="#cb68-4"></a>y=<span class="kw">numeric</span>(n)</span>
<span id="cb68-5"><a href="#cb68-5"></a>y=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">size=</span>n,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob=</span>P)</span>
<span id="cb68-6"><a href="#cb68-6"></a>rate=<span class="kw">as.matrix</span>(lambda[y,])</span>
<span id="cb68-7"><a href="#cb68-7"></a>mean1=rate[,<span class="dv">1</span>]</span>
<span id="cb68-8"><a href="#cb68-8"></a>sd1=rate[,<span class="dv">2</span>]</span>
<span id="cb68-9"><a href="#cb68-9"></a>x=<span class="kw">numeric</span>(n)</span>
<span id="cb68-10"><a href="#cb68-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb68-11"><a href="#cb68-11"></a> x[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>mean1[i],<span class="dt">sd=</span>sd1[i]) </span>
<span id="cb68-12"><a href="#cb68-12"></a>}</span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">hist</span>(x,<span class="dt">breaks =</span> <span class="st">&quot;Scott&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">hist</span>(x,<span class="dt">breaks =</span> <span class="st">&quot;FD&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>2.exercise</em></p>
<p>我们需要证明以下： <span class="math inline">\(\bullet\)</span> Suppose that <span class="math inline">\(f^{\prime \prime}\)</span> exists and <span class="math inline">\(h=c n^{-1 / 5}\)</span>. Then <span class="math display">\[
n^{2 / 5}\left(\hat{f}_{h}-f(x)\right) \leadsto N(\underbrace{\frac{c^{2}}{2} f^{\prime \prime}(x) \kappa_{21}}_{b_{x}}, \underbrace{\frac{1}{c} f(x) \kappa_{02}}_{v_{x}^{2}})
\]</span> 因为 <span class="math display">\[
\hat{f}_{h}(x)-f(x)=\frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{X_{i}-x}{h}\right)-f(x)
\]</span> 当<span class="math inline">\(lim_{n\rightarrow0}h=0\)</span>， <span class="math display">\[
f(x+u h)=f(x)+f^{\prime}(x) u h+\frac{1}{2} f^{\prime \prime}(x)(u h)^{2}+o\left((u h)^{2}\right)
\]</span> 因此：</p>
<p><span class="math display">\[\begin{align*}
E \hat{f}_{h}(x) &amp;=E\left[\frac{1}{n} \sum_{i=1}^{n} \frac{1}{h} K\left(\frac{X_{i}-x}{h}\right)\right]=\frac{1}{h} E K\left(\frac{X_{1}-x}{h}\right) \\
&amp;=\int K(u) f(x+u h) d u \\
&amp;=\int K(u)\left[f(x)+f^{\prime}(x) u h+\frac{1}{2} f^{\prime \prime}(x) u^{2} h^{2}+u^{2} o\left(h^{2}\right)\right] d u \\
&amp;=f(x)+\frac{1}{2} f^{\prime \prime}(x) \kappa_{21} h^{2}+o\left(h^{2}\right)
\end{align*}\]</span></p>
<p>且 <span class="math display">\[
\begin{array}{l}
\qquad \operatorname{Var}\left(\hat{f}_{h}(x)\right)=\operatorname{Var}\left[\frac{1}{n} \sum_{i=1}^{n} \frac{1}{h} K\left(\frac{X_{i}-x}{h}\right)\right]=\frac{1}{n} \operatorname{Var}\left(\frac{1}{h} K\left(\frac{X_{1}-x}{h}\right)\right) \\
\quad=\frac{1}{n} E\left[\frac{1}{h} K\left(\frac{X_{1}-x}{h}\right)\right]^{2}-\frac{1}{n}\left[E \frac{1}{h} K\left(\frac{X_{1}-x}{h}\right)\right]^{2} \\
\quad=\frac{1}{n h} \int K^{2}(u) f(x+u h) d u-\frac{1}{n}\left(\int K(u) f(x+u h) d u\right)^{2} \\
\quad=\frac{1}{n h} \int K^{2}(u) f(x+u h) d u-\frac{1}{n}\left(f(x)+\frac{1}{2} f^{\prime \prime}(x) \kappa_{21} h^{2}+o\left(h^{2}\right)\right)^{2} \\
\quad=\frac{f(x)}{n h} \kappa_{02}+o\left(\frac{1}{n h}\right)
\end{array}
\]</span> 所以可以得到：</p>
<p><span class="math display">\[\begin{align*}
n^{\frac{2}{5}}E\left(\hat{f}_{h}(x)-f(x)\right)&amp;=n^{\frac{2}{5}}\frac{1}{2}f^{\prime \prime}(x)\kappa_{21}h^{2}\qquad(h=cn^{-1/5})\\
&amp;=\frac{c^{2}}{2}f^{\prime \prime}(x)\kappa_{21}\\
&amp;=b_{x}
\end{align*}\]</span></p>
<p>然后我们有：</p>
<p><span class="math display">\[\begin{align*}
\operatorname{Var}\left(n^{\frac{2}{5}}(\hat{f}_{h}-f(x))\right)&amp;=n^{\frac{4}{5}}\frac{f(x)}{n h} \kappa_{02}\qquad(h=cn^{-1/5})\\
&amp;=\frac{1}{c}f(x)\kappa_{02}\\
&amp;=v_{x}^{2}\\
\end{align*}\]</span></p>
<p>因此结论成立。</p>
<p><em>3.exercise</em></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="kw">library</span>(kedd)<span class="co">##先产生100个数据点</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb71-4"><a href="#cb71-4"></a>theta&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.3</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb71-5"><a href="#cb71-5"></a>y&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb71-6"><a href="#cb71-6"></a>z&lt;-<span class="kw">as.matrix</span>(theta[y,])</span>
<span id="cb71-7"><a href="#cb71-7"></a>mean2&lt;-z[,<span class="dv">1</span>]</span>
<span id="cb71-8"><a href="#cb71-8"></a>sd2&lt;-z[,<span class="dv">2</span>]</span>
<span id="cb71-9"><a href="#cb71-9"></a>x&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</span>
<span id="cb71-11"><a href="#cb71-11"></a>  x[i]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>mean2[i],<span class="dt">sd=</span>sd2[i])  </span>
<span id="cb71-12"><a href="#cb71-12"></a>}</span>
<span id="cb71-13"><a href="#cb71-13"></a><span class="co">## 带宽选择</span></span>
<span id="cb71-14"><a href="#cb71-14"></a>h=<span class="kw">numeric</span>(<span class="dv">7</span>)</span>
<span id="cb71-15"><a href="#cb71-15"></a>h[<span class="dv">1</span>]=<span class="kw">h.amise</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>)<span class="op">$</span>h</span>
<span id="cb71-16"><a href="#cb71-16"></a>h[<span class="dv">2</span>]=<span class="kw">h.mlcv</span>(x,<span class="dt">kernel=</span> <span class="st">&quot;gaussian&quot;</span> )<span class="op">$</span>h</span>
<span id="cb71-17"><a href="#cb71-17"></a>h[<span class="dv">3</span>]=<span class="kw">h.ucv</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>)<span class="op">$</span>h</span>
<span id="cb71-18"><a href="#cb71-18"></a>h[<span class="dv">4</span>]=<span class="kw">h.bcv</span>(x,<span class="dt">whichbcv =</span> <span class="dv">1</span>,<span class="dt">deriv.order =</span> <span class="dv">0</span>)<span class="op">$</span>h</span>
<span id="cb71-19"><a href="#cb71-19"></a>h[<span class="dv">5</span>]=<span class="kw">h.ccv</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">upper=</span><span class="fl">0.5</span>)<span class="op">$</span>h</span>
<span id="cb71-20"><a href="#cb71-20"></a>h[<span class="dv">6</span>]=<span class="kw">h.mcv</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">upper=</span><span class="fl">0.5</span>)<span class="op">$</span>h</span>
<span id="cb71-21"><a href="#cb71-21"></a>h[<span class="dv">7</span>]=<span class="kw">h.tcv</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>)<span class="op">$</span>h</span>
<span id="cb71-22"><a href="#cb71-22"></a>fx=<span class="cf">function</span>(x)<span class="fl">0.3</span><span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.7</span><span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb71-23"><a href="#cb71-23"></a>hatf=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">1</span>])</span>
<span id="cb71-24"><a href="#cb71-24"></a>hatf1=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">2</span>])</span>
<span id="cb71-25"><a href="#cb71-25"></a>hatf2=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">3</span>])</span>
<span id="cb71-26"><a href="#cb71-26"></a>hatf3=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">4</span>])</span>
<span id="cb71-27"><a href="#cb71-27"></a>hatf4=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">5</span>])</span>
<span id="cb71-28"><a href="#cb71-28"></a>hatf5=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">6</span>])</span>
<span id="cb71-29"><a href="#cb71-29"></a>hatf6=<span class="kw">dkde</span>(x,<span class="dt">deriv.order =</span> <span class="dv">0</span>,<span class="dt">h=</span>h[<span class="dv">7</span>])</span>
<span id="cb71-30"><a href="#cb71-30"></a><span class="co">##画图</span></span>
<span id="cb71-31"><a href="#cb71-31"></a>z=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">0.05</span>)</span>
<span id="cb71-32"><a href="#cb71-32"></a><span class="kw">plot</span>(z,<span class="kw">fx</span>(z),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;kernel density estimation&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.2</span>),<span class="dt">type =</span> <span class="st">&quot;c&quot;</span>)</span>
<span id="cb71-33"><a href="#cb71-33"></a><span class="kw">lines</span>(hatf,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb71-34"><a href="#cb71-34"></a><span class="kw">lines</span>(hatf1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb71-35"><a href="#cb71-35"></a><span class="kw">lines</span>(hatf2,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb71-36"><a href="#cb71-36"></a><span class="kw">lines</span>(hatf3,<span class="dt">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb71-37"><a href="#cb71-37"></a><span class="kw">lines</span>(hatf4,<span class="dt">col=</span><span class="st">&quot;blue4&quot;</span>)</span>
<span id="cb71-38"><a href="#cb71-38"></a><span class="kw">lines</span>(hatf5,<span class="dt">col=</span><span class="st">&quot;antiquewhite4&quot;</span>)</span>
<span id="cb71-39"><a href="#cb71-39"></a><span class="kw">lines</span>(hatf6,<span class="dt">col=</span><span class="st">&quot;aquamarine4&quot;</span>)</span>
<span id="cb71-40"><a href="#cb71-40"></a><span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</span>
<span id="cb71-41"><a href="#cb71-41"></a><span class="kw">plot</span>(fx,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.2</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb71-42"><a href="#cb71-42"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;f(x)&quot;</span>,<span class="st">&quot;h.amise&quot;</span>,<span class="st">&quot;h.mlcv&quot;</span>,<span class="st">&quot;h.ucv&quot;</span>,<span class="st">&quot;h.bcv&quot;</span>,<span class="st">&quot;h.ccv&quot;</span>,<span class="st">&quot;h.mcv&quot;</span>,<span class="st">&quot;h.tcv&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;brown&quot;</span>,<span class="st">&quot;blue4&quot;</span>,<span class="st">&quot;antiquewhite4&quot;</span>,<span class="st">&quot;aquamarine4&quot;</span>),<span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><em>4.exercise</em></p>
<p>需要我们证明: <span class="math display">\[
h_{B}=h_{A}\frac{\delta_{0}^{B}}{\delta_{0}^{A}}
\]</span> 首先 让<span class="math inline">\(T(K_{A})=\kappa_{02} / \delta_{0}^{A}\)</span>, 然后</p>
<p><span class="math display">\[\begin{align*}
A M I S E(K^{A})&amp;=\frac{\left\|K^{A}\right\|^{2}}{n h_{A}}+\frac{h_{A}^{4}}{n}\left\|f^{\prime \prime}\right\|^{2}\mu_{2}^{2}(K^{A})\\
&amp;=\frac{T(K^{A})\delta_{0}^{A}}{n h_{A}}+\frac{h_{A}^{4}}{n(\delta_{0}^{A})^{4}}\left\|f^{\prime \prime}\right\|^{2}T(K^{A})\\
&amp;=\left(\frac{\delta_{0}^{A}}{nh_{A}}+\frac{h_{A}^{4}}{n(\delta_{0}^{A})^{4}}\left\|f^{\prime \prime}\right\|^{2}\right)T(K^{A})\\
\end{align*}\]</span></p>
<p>让<span class="math inline">\(T(K_{B})=\kappa_{02} / \delta_{0}^{B}\)</span>, 然后</p>
<p><span class="math display">\[\begin{align*}
A M I S E(K^{B})&amp;=\frac{\left\|K^{B}\right\|^{2}}{n h_{B}}+\frac{h_{B}^{4}}{n}\left\|f^{\prime \prime}\right\|^{2}\mu_{2}^{2}(K^{B})\\
&amp;=\frac{T(K^{B})\delta_{0}^{B}}{n h_{B}}+\frac{h_{B}^{4}}{n(\delta_{0}^{B})^{4}}\left\|f^{\prime \prime}\right\|^{2}T(K^{B})\\
&amp;=\left(\frac{\delta_{0}^{B}}{nh_{B}}+\frac{h_{B}^{4}}{n(\delta_{0}^{B})^{4}}\left\|f^{\prime \prime}\right\|^{2}\right)T(K^{B})\\
\end{align*}\]</span></p>
<p>可知要使两者的平滑效果相同，则 <span class="math display">\[
\begin{array}{l}
\quad AMISE(K^{A})=AMISE(K^{B})\\
\quad \frac{h_{B}}{\delta_{0}^{B}}=\frac{h_{A}}{\delta_{o}^{A}}\\
\quad h_{B}=h_{A}\frac{\delta_{0}^{B}}{\delta_{0}^{A}}\\
\end{array}
\]</span></p>
</div>
<div id="section-8" class="section level2">
<h2>2020-11-24</h2>
<p><em>1.exercise</em></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>N=<span class="fl">1e4</span></span>
<span id="cb72-3"><a href="#cb72-3"></a>n1=<span class="dv">444</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>n2=<span class="dv">132</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>n3=<span class="dv">361</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>n4=<span class="dv">63</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>n=<span class="kw">c</span>(n1,n2,n3,n4)</span>
<span id="cb72-8"><a href="#cb72-8"></a>L=<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>)</span>
<span id="cb72-9"><a href="#cb72-9"></a>tol=<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb72-10"><a href="#cb72-10"></a>L.old=L<span class="op">+</span><span class="dv">1</span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb72-12"><a href="#cb72-12"></a>  mu1=<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">sum</span>(n))<span class="op">*</span>(n4<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">-</span>L[<span class="dv">1</span>])))</span>
<span id="cb72-13"><a href="#cb72-13"></a>  mu2=<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">sum</span>(n))<span class="op">*</span>(n4<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])))</span>
<span id="cb72-14"><a href="#cb72-14"></a>  mu3=<span class="dv">1</span><span class="op">-</span>mu1<span class="op">-</span>mu2</span>
<span id="cb72-15"><a href="#cb72-15"></a>  L=<span class="kw">c</span>(mu1,mu2,mu3)</span>
<span id="cb72-16"><a href="#cb72-16"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L <span class="op">-</span><span class="st"> </span>L.old)<span class="op">/</span>L.old) <span class="op">&lt;</span><span class="st"> </span>tol) <span class="cf">break</span></span>
<span id="cb72-17"><a href="#cb72-17"></a>  L.old=L</span>
<span id="cb72-18"><a href="#cb72-18"></a>}</span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">p=</span> L[<span class="dv">1</span>],<span class="dt">q=</span>L[<span class="dv">2</span>], <span class="dt">iter =</span> j, <span class="dt">tol =</span> tol))</span></code></pre></div>
<p>2.Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb73-2"><a href="#cb73-2"></a>N=<span class="fl">1e4</span></span>
<span id="cb73-3"><a href="#cb73-3"></a>n1=<span class="dv">444</span></span>
<span id="cb73-4"><a href="#cb73-4"></a>n2=<span class="dv">132</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>n3=<span class="dv">361</span></span>
<span id="cb73-6"><a href="#cb73-6"></a>n4=<span class="dv">63</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>n=<span class="kw">c</span>(n1,n2,n3,n4)</span>
<span id="cb73-8"><a href="#cb73-8"></a>L=<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>)</span>
<span id="cb73-9"><a href="#cb73-9"></a>tol=<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb73-10"><a href="#cb73-10"></a>L.old=L<span class="op">+</span><span class="dv">1</span></span>
<span id="cb73-11"><a href="#cb73-11"></a>p=<span class="kw">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb73-12"><a href="#cb73-12"></a>q=<span class="kw">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb73-13"><a href="#cb73-13"></a>l=<span class="kw">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb73-14"><a href="#cb73-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb73-15"><a href="#cb73-15"></a>  mu1=<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">sum</span>(n))<span class="op">*</span>(n4<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">-</span>L[<span class="dv">1</span>])))</span>
<span id="cb73-16"><a href="#cb73-16"></a>  mu2=<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">sum</span>(n))<span class="op">*</span>(n4<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])))</span>
<span id="cb73-17"><a href="#cb73-17"></a>  mu3=<span class="dv">1</span><span class="op">-</span>mu1<span class="op">-</span>mu2</span>
<span id="cb73-18"><a href="#cb73-18"></a>  L=<span class="kw">c</span>(mu1,mu2,mu3)</span>
<span id="cb73-19"><a href="#cb73-19"></a>  p[j]=mu1</span>
<span id="cb73-20"><a href="#cb73-20"></a>  q[j]=mu2</span>
<span id="cb73-21"><a href="#cb73-21"></a>  l[j]=n1<span class="op">*</span><span class="kw">log</span>(mu1<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>mu1<span class="op">*</span>mu3)<span class="op">+</span>n2<span class="op">*</span><span class="kw">log</span>(mu2<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>mu2<span class="op">*</span>mu3)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span>n3)<span class="op">*</span><span class="kw">log</span>(mu3)<span class="op">+</span>n4<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>mu1<span class="op">*</span>mu2)</span>
<span id="cb73-22"><a href="#cb73-22"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L <span class="op">-</span><span class="st"> </span>L.old)<span class="op">/</span>L.old) <span class="op">&lt;</span><span class="st"> </span>tol) <span class="cf">break</span></span>
<span id="cb73-23"><a href="#cb73-23"></a>  L.old=L</span>
<span id="cb73-24"><a href="#cb73-24"></a>}</span>
<span id="cb73-25"><a href="#cb73-25"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">p=</span>p,<span class="dt">q=</span>q,<span class="dt">l=</span>l))</span></code></pre></div>
<p>they are increasing.</p>
<p><em>2.exercise</em></p>
<ol style="list-style-type: decimal">
<li>使用lapply函数：</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>mpg=mtcars<span class="op">$</span>mpg</span>
<span id="cb74-2"><a href="#cb74-2"></a>disp=mtcars<span class="op">$</span>disp</span>
<span id="cb74-3"><a href="#cb74-3"></a>wt=mtcars<span class="op">$</span>wt</span>
<span id="cb74-4"><a href="#cb74-4"></a>formulas=<span class="kw">list</span>(</span>
<span id="cb74-5"><a href="#cb74-5"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb74-6"><a href="#cb74-6"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb74-7"><a href="#cb74-7"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb74-8"><a href="#cb74-8"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb74-9"><a href="#cb74-9"></a>)</span>
<span id="cb74-10"><a href="#cb74-10"></a>fit.models=<span class="cf">function</span>(i){</span>
<span id="cb74-11"><a href="#cb74-11"></a>  <span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb74-12"><a href="#cb74-12"></a>}</span>
<span id="cb74-13"><a href="#cb74-13"></a><span class="kw">lapply</span>(<span class="kw">seq_along</span>(formulas), fit.models)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>2.使用loop循环：</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>mpg=mtcars<span class="op">$</span>mpg</span>
<span id="cb76-2"><a href="#cb76-2"></a>disp=mtcars<span class="op">$</span>disp</span>
<span id="cb76-3"><a href="#cb76-3"></a>wt=mtcars<span class="op">$</span>wt</span>
<span id="cb76-4"><a href="#cb76-4"></a>formulas=<span class="kw">list</span>(</span>
<span id="cb76-5"><a href="#cb76-5"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb76-6"><a href="#cb76-6"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb76-7"><a href="#cb76-7"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb76-8"><a href="#cb76-8"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb76-9"><a href="#cb76-9"></a>)</span>
<span id="cb76-10"><a href="#cb76-10"></a>out=<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</span>
<span id="cb76-12"><a href="#cb76-12"></a>out[[i]]=<span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb76-13"><a href="#cb76-13"></a>}</span>
<span id="cb76-14"><a href="#cb76-14"></a>out</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p><em>3.exercise</em></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co">##the anonymous function is defined</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="dv">100</span>,</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb78-7"><a href="#cb78-7"></a>)</span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(f)f<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.92573839 0.38341791 0.21070462 0.41458918 0.26121206 0.72223937
##   [7] 0.29887169 0.95162894 0.26398664 0.62018151 0.51388383 0.94676108
##  [13] 0.05206634 0.94395869 0.90872276 0.91948631 0.66419598 0.29837025
##  [19] 0.29940554 0.83506207 0.45274078 0.90320828 0.79263778 0.45399170
##  [25] 0.38923722 0.69542630 0.26739653 0.38567329 0.31137487 0.36010634
##  [31] 0.39754771 0.72253407 0.42186171 0.12771643 0.23170443 0.68265125
##  [37] 0.71252902 0.12724649 0.75353630 0.94884686 0.87276882 0.41388298
##  [43] 0.25224053 0.84404036 0.16580146 0.42473329 0.82280924 0.71272703
##  [49] 0.30947058 0.92816784 0.27134690 0.62008647 0.49758173 0.02775463
##  [55] 0.78775614 0.26248714 0.77273771 0.68416168 0.08687832 0.04574362
##  [61] 0.44178950 0.36827740 0.64265435 0.47847663 0.10832740 0.75695184
##  [67] 0.61642417 0.01474650 0.18023871 0.42316145 0.38702375 0.27030894
##  [73] 0.92266032 0.75504614 0.65781938 0.34910615 0.22083614 0.53165720
##  [79] 0.14727409 0.50490437 0.42920650 0.71256710 0.72931439 0.90676814
##  [85] 0.85988192 0.87366680 0.91047506 0.99255659 0.15198012 0.09537499
##  [91] 0.37213020 0.96151424 0.97595090 0.30669922 0.42738809 0.75571001
##  [97] 0.15155800 0.06214524 0.29324608 0.83599679</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>x=<span class="kw">list</span>(<span class="kw">runif</span>(<span class="dv">11</span>), <span class="kw">runif</span>(<span class="dv">6</span>)) </span>
<span id="cb80-2"><a href="#cb80-2"></a>y=<span class="kw">list</span>(<span class="kw">rpois</span>(<span class="dv">11</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">rpois</span>(<span class="dv">6</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="kw">vapply</span>(<span class="kw">Map</span>(weighted.mean,x,y),<span class="cf">function</span>(x) x,<span class="dt">FUN.VALUE =</span> <span class="kw">c</span>(<span class="dt">a=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 0.4950823 0.3812716</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>2020-12-01</h2>
<p><em>2.exercise</em></p>
<p>That is the R function we wrote before.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">set.seed</span>(<span class="dv">3000</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb82-3"><a href="#cb82-3"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb82-4"><a href="#cb82-4"></a> x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb82-5"><a href="#cb82-5"></a> x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb82-6"><a href="#cb82-6"></a> u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb82-7"><a href="#cb82-7"></a> k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb82-8"><a href="#cb82-8"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb82-9"><a href="#cb82-9"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb82-10"><a href="#cb82-10"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb82-11"><a href="#cb82-11"></a>  <span class="cf">else</span> {</span>
<span id="cb82-12"><a href="#cb82-12"></a>  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb82-13"><a href="#cb82-13"></a>  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb82-14"><a href="#cb82-14"></a>  }</span>
<span id="cb82-15"><a href="#cb82-15"></a> }</span>
<span id="cb82-16"><a href="#cb82-16"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb82-17"><a href="#cb82-17"></a>}</span>
<span id="cb82-18"><a href="#cb82-18"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb82-19"><a href="#cb82-19"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb82-20"><a href="#cb82-20"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb82-21"><a href="#cb82-21"></a>rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb82-22"><a href="#cb82-22"></a>rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb82-23"><a href="#cb82-23"></a>rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb82-24"><a href="#cb82-24"></a>rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb82-25"><a href="#cb82-25"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb82-26"><a href="#cb82-26"></a>Rej =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</span>
<span id="cb82-27"><a href="#cb82-27"></a>Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb82-28"><a href="#cb82-28"></a><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></span>
<span id="cb82-29"><a href="#cb82-29"></a><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</span>
<span id="cb82-30"><a href="#cb82-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</span>
<span id="cb82-31"><a href="#cb82-31"></a><span class="co">#plot</span></span>
<span id="cb82-32"><a href="#cb82-32"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb82-33"><a href="#cb82-33"></a>    rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb82-34"><a href="#cb82-34"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb82-35"><a href="#cb82-35"></a>        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb82-36"><a href="#cb82-36"></a>             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb82-37"><a href="#cb82-37"></a>             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb82-38"><a href="#cb82-38"></a>    }</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>o=<span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb83-2"><a href="#cb83-2"></a>zr=<span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb83-4"><a href="#cb83-4"></a>  zr[i]=<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(o[i]))<span class="op">*</span><span class="kw">as.numeric</span>(o[i]<span class="op">&lt;=</span><span class="fl">0.5</span>)<span class="op">+</span>(<span class="op">-</span><span class="kw">log</span>(<span class="dv">2-2</span><span class="op">*</span>o[i]))<span class="op">*</span><span class="kw">as.numeric</span>(o[i]<span class="op">&gt;</span><span class="fl">0.5</span>)</span>
<span id="cb83-5"><a href="#cb83-5"></a>}</span>
<span id="cb83-6"><a href="#cb83-6"></a>zx1=<span class="kw">quantile</span>(y1,o)</span>
<span id="cb83-7"><a href="#cb83-7"></a>zx2=<span class="kw">quantile</span>(y2,o)</span>
<span id="cb83-8"><a href="#cb83-8"></a>zx3=<span class="kw">quantile</span>(y3,o)</span>
<span id="cb83-9"><a href="#cb83-9"></a>zx4=<span class="kw">quantile</span>(y4,o)</span>
<span id="cb83-10"><a href="#cb83-10"></a>zy1=<span class="kw">quantile</span>(rw1<span class="op">$</span>x,o)</span>
<span id="cb83-11"><a href="#cb83-11"></a>zy2=<span class="kw">quantile</span>(rw2<span class="op">$</span>x,o)</span>
<span id="cb83-12"><a href="#cb83-12"></a>zy3=<span class="kw">quantile</span>(rw3<span class="op">$</span>x,o)</span>
<span id="cb83-13"><a href="#cb83-13"></a>zy4=<span class="kw">quantile</span>(rw4<span class="op">$</span>x,o)</span>
<span id="cb83-14"><a href="#cb83-14"></a><span class="kw">qqplot</span>(zx1,zy1,<span class="dt">xlab =</span> <span class="st">&quot;RcPP Function&quot;</span>,<span class="dt">ylab =</span><span class="st">&quot;R Function&quot;</span> )</span>
<span id="cb83-15"><a href="#cb83-15"></a><span class="kw">qqline</span>(zy1)</span>
<span id="cb83-16"><a href="#cb83-16"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-17"><a href="#cb83-17"></a><span class="kw">qqplot</span>(zx2,zy2,<span class="dt">xlab =</span> <span class="st">&quot;RcPP Function&quot;</span>,<span class="dt">ylab =</span><span class="st">&quot;R Function&quot;</span>)</span>
<span id="cb83-18"><a href="#cb83-18"></a><span class="kw">qqline</span>(zy2)</span>
<span id="cb83-19"><a href="#cb83-19"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-20"><a href="#cb83-20"></a><span class="kw">qqplot</span>(zx3,zy3,<span class="dt">xlab =</span> <span class="st">&quot;RcPP Function&quot;</span>,<span class="dt">ylab =</span><span class="st">&quot;R Function&quot;</span>)</span>
<span id="cb83-21"><a href="#cb83-21"></a><span class="kw">qqline</span>(zy3)</span>
<span id="cb83-22"><a href="#cb83-22"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-23"><a href="#cb83-23"></a><span class="kw">qqplot</span>(zx4,zy4,<span class="dt">xlab =</span> <span class="st">&quot;RcPP Function&quot;</span>,<span class="dt">ylab =</span><span class="st">&quot;R Function&quot;</span>)</span>
<span id="cb83-24"><a href="#cb83-24"></a><span class="kw">qqline</span>(zy4)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
